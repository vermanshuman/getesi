<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/resources/tpl/Admin/LazyListTabBase.xhtml">
    <ui:param name="bean" value="#{clientListBean}"/>
    <ui:param name="list_header" value="#{msg.client}"/>
    <ui:param name="excludeColumns" value="0,1,2"/>
    <ui:param name="page_header" value="#{msg.categoryPercentValueCategoryCode}"/>
    <ui:define name="list_body">
        <style>
            .row {
                display: flex;
                gap: 5%;
            }
            .title-txt {
                font-size: 40px;
                margin-left: 5px;
            }
            .row {
                display: flex;
            }
            body .ui-panel .ui-panel-content {
                border: none !important;
            }

            body .ui-datatable .ui-paginator.ui-paginator-top {
                background-color: #788FA7 !important;
                color: #ffffff !important;
            }
            .mail-button {
                background: #00CC52 !important;
            }

            .searchPanelButton {
                background: #fb6e51 !important;
            }
            .cartelle-btn {
                background:  #ff8b00 !important;
            }
            .ui-chkbox.ui-chkbox-all.ui-widget {
                display: none;
            }

            .table-demo {
                margin-right: 0rem;
                margin-left: 0rem;
                margin-top: 0rem;
            }

            body .ui-datatable .ui-datatable-data tr.ui-datatable-even {
                background-color: #f0f3f5 !important;
            }

            .ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td, .ui-datatable tfoot th {
                border: 1px solid #c9cdd2 !important;
            }

            .ui-datatable tbody td, .ui-datatable tfoot td {
                border-width: 0 1px 1px 0 !important;
            }

            body .ui-datatable #contactTable_head th, body .ui-datatable #gestoreTable_head th,
            body .ui-datatable #fiduciaryTable_head th {
                background-color: #f8f9fa !important;
                color: #495057 !important;
            }

            body .ui-datatable #contactTable_head th .ui-column-title, body .ui-datatable #gestoreTable_head th .ui-column-title,
            body .ui-datatable #fiduciaryTable_head th .ui-column-title {
                color: #5f666c !important;
            }

            body .ui-datatable .ui-datatable-data tr td {
                padding: 6px 6px !important;
            }

            body .table-client-list.ui-datatable #contactTable_data tr td, body .table-client-list.ui-datatable #gestoreTable_data tr td,
            body .table-client-list.ui-datatable #fiduciaryTable_data tr td {
                color: #4c5156 !important;
            }

            body .ui-datatable thead th.ui-state-active {
                color: #2196F3 !important;
            }

            body .ui-datatable .ui-datatable-data > tr:hover {
                background: #e9ecef !important;
            }

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-pages .ui-paginator-page, body .ui-paginator .ui-paginator-first, body .ui-paginator .ui-paginator-prev, body .ui-paginator .ui-paginator-next, body .ui-paginator .ui-paginator-last {
                color: #6c757d !important;
            }

            body .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                background: #2196F3 !important;
                color: #ffffff !important;
            }
            .table-demo .p-col-12, .table-demo .card {
                padding: 0;
                border: none;
            }
            .ui-datatable-gridlines.td {
                border-width: 1px !important;
            }

            body .ui-datatable .ui-datatable-header {
                border-top: 2px solid #c9cdd2 !important;
            }

            .card {
                border: none !important;
                padding-bottom: 0px !important;
                margin-bottom: 0px !important;
                padding-top: 0px !important;
            }

            #table_div_content{
                padding-top: 0px !important;
            }
            .ui-datatable-header {
                padding-top: 5px !important;
                padding-bottom: 5px !important;
            }

            body {
                font-family: "cabin", sans-serif !important;
                font-size: 1rem !important;
                text-decoration: none;
            }

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-pages .ui-paginator-page,
            body .ui-paginator .ui-paginator-first, body .ui-paginator .ui-paginator-prev,
            body .ui-paginator .ui-paginator-next, body .ui-paginator .ui-paginator-last {
                color: #FFFFFF !important;
            }

            body .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                background: #FFF !important;
                color: #000000 !important;
            }


            .layout-wrapper .route-bar {
                border-bottom: 1px solid #c9cdd2;
            }

            .layout-footer {
                border-top: 1px solid #c9cdd2;
            }

            .ui-datatable tbody.ui-datatable-data {
                border-left: 1px solid #c9cdd2;
            }

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-rpp-options {
                margin: 0;
            }
            body .ui-widget, body .ui-widget .ui-widget {
                font-family: "Open Sans","Helvetica Neue",sans-serif !important;
                text-decoration: none !important;
                font-size: 14px !important;
                /*font-weight: normal !important;*/
            }

            #states_panel {
                background: #ffffff;
                color: #495057;
                padding: 0;
                border: 0 none;
                box-shadow: 0px 11px 15px -7px rgb(0 0 0 / 20%), 0px 24px 38px 3px rgb(0 0 0 / 14%), 0px 9px 46px 8px rgb(0 0 0 / 12%);
                border-radius: 4px;
            }

            #states_panel .ui-selectcheckboxmenu-items-wrapper {
                padding: 0px 1rem 1rem 1rem;
            }

            #states_panel .ui-selectcheckboxmenu-header {
                margin: 1rem 1rem 0px 1rem;
                border: 1px solid #808080 ;
                background-color: #D9E0E7 !important;
                color: #000000 !important;
            }

            #states_panel .ui-selectcheckboxmenu-list-item {
                border: 1px solid #c9cdd2;
                border-top: none;
            }

            #states_panel .ui-selectcheckboxmenu-close {
                display: none;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item label {
                color: #295887;
                font-weight: 600;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item {
                border: 1px solid;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item .ui-chkbox .ui-chkbox-box.ui-state-hover {
                border: 2px solid #4D759D;
            }

            body .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-items {
                padding: 0 0;
            }

            body .ui-chkbox .ui-chkbox-box.ui-state-active {
                border-color: #4D759D;
                color: #5f666c !important;
                background-color: transparent !important;
            }

            #filterDateFrom_input {
                width: 160px;
            }

            #filterDateTo_input {
                width: 160px;
            }
            body .ui-datatable thead th {
                border-color: #c9cdd2 !important;
            }

            body .ui-inputfield {
                border: 1px solid #a8acb1;
            }

            body .ui-chkbox .ui-chkbox-box .ui-chkbox-icon.ui-icon-check {
                font-weight: bolder;
            }
            .calender-filled input, .select-checkbox {
                border: 0.2em  solid #57c279 !important;
            }
            body .ui-inputfield.ui-state-focus {
                box-shadow: 0 0 0 0.2em #57c279 !important;
            }

            body .ui-selectcheckboxmenu.ui-state-focus:not(.ui-state-error) {
                box-shadow: 0 0 0 0.2em #57c279 !important;
            }

            .border_class{
                border: 0.2em solid #57c279 !important; border-radius: 7px !important;
            }

            #filterEmailsender.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }

            #filterEmailSubject.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }

            #filterEmailBody.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }
        </style>

        <link href="#{facesContext.externalContext.requestContextPath}/resources/styles/client.css"
              media="all" rel="stylesheet" type="text/css"/>
        <div class="row title-txt">

            <h:outputText value=" #{msg.clients}" rendered="#{bean.tab eq 1}"/>
            <h:outputText value=" #{msg.requestManagers}" rendered="#{bean.tab eq 2}"/>
            <h:outputText value=" #{msg.requestTrustees}" rendered="#{bean.tab eq 3}"/>
        </div>

        <p:panelGrid styleClass="ui-panelgrid-blank form-group fiend-panel" style="width: 100%"
                     rendered="#{bean.tab eq null}">
            <p:row>
                <p:column style="width: 20%!important;">
                    <p:inputText value="#{bean.nameOfTheCompany}" placeholder="#{msg.clientShortNameOfTheCompany}"
                                 maxlength="100"
                                 styleClass="input-width"
                                 id="nameOfTheCompany" label="#{msg.clientShortNameOfTheCompany}"/>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:inputText value="#{bean.numberVAT}" maxlength="11" placeholder="#{msg.clientVATNumber}"
                                 id="numberVAT" styleClass="input-width"
                                 label="#{msg.clientVATNumber}"/>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:selectOneMenu id="province" value="#{bean.addressProvinceId}"
                                     label="#{msg.clientAddressProvince}"
                                     styleClass="selectOneLabel">
                        <p:ajax update="province, city, country"
                                listener="#{clientListBean.handleAddressProvinceChange}"/>
                        <f:selectItems value="#{bean.provinces}"/>
                    </p:selectOneMenu>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:selectOneMenu id="city" value="#{bean.addressCityId}" styleClass="selectOneLabel"
                                     style="display: #{bean.foreignCountry ? 'none' : ''};"
                                     label="#{msg.clientAddressCity}">
                        <f:selectItems value="#{bean.addressCities}"/>
                    </p:selectOneMenu>

                    <p:selectOneMenu id="country" value="#{bean.selectedCountryId}" styleClass="selectOneLabel"
                                     style="display: #{bean.foreignCountry ? '' : 'none'};"
                                     label="#{msg.databaseListSubjectCity}:">
                        <f:selectItems value="#{bean.countries}"/>
                    </p:selectOneMenu>
                </p:column>
                <p:column style="width: 1%!important;">
                    <p:commandButton value="#{msg.search.toUpperCase()}" styleClass="grey-button right-side"
                                     action="#{bean.searchClients}" update=":form:tabs"/>
                </p:column>
            </p:row>
        </p:panelGrid>

        <div class="p-grid">
            <div class="p-col-6">
                <div class="p-formgroup-inline">
                    <div class="p-field">
                        <p:commandButton disabled="#{!bean.canCreate}" styleClass="green-button"
                                         value="#{msg.newItem.toUpperCase()}"
                                         action="#{bean.addEntity}" style="#{bean.tab ne null ? 'margin-top:20px' : ''}"/>
                    </div>
                </div>
            </div>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 1}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu id="contactClientType" value="#{bean.selectedClientTypeId}" style="border: 2px solid #ced4da;"
                                         styleClass="select-width" label="#{msg.clientType}" placeholder="#{msg.clientType}">
                        <p:ajax update="@this"/>
                            <f:selectItems value="#{bean.clientTypes}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                    <p:inputText value="#{bean.nameOfTheCompany}"
                                 maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"
                                     id="contactNameOfTheCompany" label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon"
                                         action="#{bean.searchClients}"
                                         update="contactTable"/>
                    </div>
                </div>
            </p:outputPanel>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 2}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu value="#{bean.selectedClientId}"
                                         label="#{msg.invoiceClient}"
                                         filter="true" placeholder="#{msg.client}"
                                         filterMatchMode="startsWith"
                                         styleClass="select-width">
                            <p:ajax listener="#{bean.onClientSelect}"
                                    update="@this"/>
                            <f:selectItems value="#{bean.clients}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:inputText value="#{bean.nameOfTheCompany}"
                                     maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"  label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon" action="#{bean.searchClients}" update="gestoreTable"/>
                    </div>
                </div>
            </p:outputPanel>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 3}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu value="#{bean.selectedClientId}"
                                         label="#{msg.invoiceClient}"
                                         filter="true" placeholder="#{msg.client}"
                                         filterMatchMode="startsWith"
                                         styleClass="select-width">
                            <p:ajax listener="#{bean.onClientSelect}"
                                    update="@this"/>
                            <f:selectItems value="#{bean.clients}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:inputText value="#{bean.nameOfTheCompany}"
                                     maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"  label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon" action="#{bean.searchClients}" update="fiduciaryTable"/>
                    </div>
                </div>
            </p:outputPanel>
        </div>
        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 1}">
            <p:outputPanel style="margin-top: 20px;">
            <p:dataTable var="item" id="contactTable" styleClass="table-client-list"
                             emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyModel}"
                             paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                             paginatorAlwaysVisible="true"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,20,50" widgetVar="table">
                    <p:column sortBy="#{item.clientName}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{msg.clientNameOfTheCompany.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientAddressCity.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item.addressCityId}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientMail.toUpperCase()}" />
                        </f:facet>
                        <!-- <h:outputText value="#{item.emails}"/> -->
                        <ui:repeat value="#{item.emails}" var="email">
                            <h:outputText value="#{email.email}" />
                            <h:outputText value="&lt;br /&gt;" escape="false" />
                        </ui:repeat>
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientPhone.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item.phone}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <p:selectCheckboxMenu value="#{bean.selectedKindList}"
                                                  label="#{msg.roleType.toUpperCase()}"
                                                  style="background: none !important; border: none !important;">
                                <f:selectItems value="#{bean.kindList}" var="kind"
                                               itemValue="#{kind.value}" itemLabel="#{kind.label}" />
                                <p:ajax event="change" listener="#{bean.searchClients}"
                                        update="contactTable" />
                                <p:ajax event="toggleSelect" listener="#{bean.searchClients}"
                                        update="contactTable" />
                            </p:selectCheckboxMenu>
                        </f:facet>
                        <h:outputText value="#{item.kind}" />
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton disabled="#{!bean.canDelete}"
                                         styleClass="red-btn"
                                         icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityDeleteId}" />
                        </p:commandButton>
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                         action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">

                        <p:commandButton icon="ui-icon pi pi-pencil" update=":form"
                                         style="border: none !important;"
                                         action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}" />
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

                <p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
                                 icon="fa fa-file-excel-o"
                                 style="margin-top: 20px;  left: 100%;
                                    transform:translate(-100%, 0);"
                                 styleClass="grey-button" ajax="false">
                    <p:dataExporter type="xls" target="table" fileName="#{list_title}"
                                    excludeColumns="#{excludeColumns}" />
                </p:commandButton>
            </p:outputPanel>
        </p:outputPanel>

        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 2}">
        <p:outputPanel style="margin-top: 20px;">
            <p:dataTable var="item" id="gestoreTable"
                         styleClass="table-client-list"
                         emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyManagerClientModel}"
                         paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                         paginatorAlwaysVisible="true"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                <p:column sortBy="#{item.clientName}">
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="#{msg.titleOffice.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item.office}"/>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                    </f:facet>
                    <!-- <h:outputText value="#{item.emails}"/> -->
                    <ui:repeat value="#{item.emails}" var="email">
                        <h:outputText value="#{email.email}"/>
                        <h:outputText value="&lt;br /&gt;" escape="false"/>
                    </ui:repeat>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item.phone}"/>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.client}"/>
                    </f:facet>
                    <h:outputText value="#{item.clients}"/>
                </p:column>
                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton disabled="#{!bean.canDelete}" styleClass="red-btn"
                                     icon="ui-icon pi pi-times"
                                     oncomplete="PF('dlg2').show()">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityDeleteId}"/>
                    </p:commandButton>
                </p:column>

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                     action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityEditId}"/>
                    </p:commandButton>
                </p:column>

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon pi pi-pencil" update=":form"   style="border: none !important;"
                                     action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityEditId}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>

        </p:outputPanel>
        </p:outputPanel>

        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 3}">
            <p:outputPanel style="margin-top: 20px;">
                <p:dataTable var="item" id="fiduciaryTable"
                             styleClass="table-client-list"
                             emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyClientTrustModel}"
                             paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                             paginatorAlwaysVisible="true"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                    <p:column sortBy="#{item.clientName}">
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item}"/>
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item.addressCityId}"/>
                    </p:column>

                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                        </f:facet>
                        <!-- <h:outputText value="#{item.emails}"/> -->
                        <ui:repeat value="#{item.emails}" var="email">
                            <h:outputText value="#{email.email}"/>
                            <h:outputText value="&lt;br /&gt;" escape="false"/>
                        </ui:repeat>
                    </p:column>

                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item.phone}"/>
                    </p:column>
                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.client}"/>
                        </f:facet>
                        <h:outputText value="#{item.clients}"/>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton disabled="#{!bean.canDelete}"
                                         icon="ui-icon pi pi-times" styleClass="red-btn"
                                         oncomplete="PF('dlg2').show()">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityDeleteId}"/>
                        </p:commandButton>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                         action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                         action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

            </p:outputPanel>
        </p:outputPanel>
        <p:tabView dynamic="true" cache="true" id="tabs" activeIndex="#{bean.activeClientListIndex}" rendered="#{bean.tab eq null}">
            <p:ajax event="tabChange" listener="#{bean.onTabChange}"/>
            <p:tab title="#{msg.clients}">
				<p:outputPanel style="margin-top: 20px;">
					<p:panelGrid columns="3"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
						<p:column style="width: 10%!important;">
							<h:outputText value="#{msg.clientType}:" />
							<p:selectOneMenu id="clientType" value="#{bean.selectedClientTypeId}" 
								styleClass="select-width" label="#{msg.clientType}">
								<p:ajax listener="#{bean.searchClients}" update="table" />
                                <f:selectItems value="#{bean.clientTypes}"/>
                            </p:selectOneMenu>
						</p:column>
					</p:panelGrid>
					<p:dataTable var="item" id="table" styleClass="table-client-list"
						emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyModel}"
						paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
						paginatorAlwaysVisible="true"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						rowsPerPageTemplate="10,20,50" widgetVar="table">

						<p:column sortBy="#{item.clientName}"
							filterBy="#{item.clientName}">
							<f:facet name="header">
								<h:outputText
									value="#{msg.clientNameOfTheCompany.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientAddressCity.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.addressCityId}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientMail.toUpperCase()}" />
							</f:facet>
							<!-- <h:outputText value="#{item.emails}"/> -->
							<ui:repeat value="#{item.emails}" var="email">
								<h:outputText value="#{email.email}" />
								<h:outputText value="&lt;br /&gt;" escape="false" />
							</ui:repeat>
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientPhone.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.phone}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<p:selectCheckboxMenu value="#{bean.selectedKindList}"
									label="#{msg.roleType.toUpperCase()}"
									style="background: none !important; border: none !important;">
									<f:selectItems value="#{bean.kindList}" var="kind"
										itemValue="#{kind.value}" itemLabel="#{kind.label}" />
									<p:ajax event="change" listener="#{bean.searchClients}"
										update="table" />
									<p:ajax event="toggleSelect" listener="#{bean.searchClients}"
										update="table" />
								</p:selectCheckboxMenu>
							</f:facet>
							<h:outputText value="#{item.kind}" />
						</p:column>

						<p:column styleClass="action_column" exportable="false">
							<p:commandButton disabled="#{!bean.canDelete}"
                                             styleClass="red-btn"
                                             icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityDeleteId}" />
							</p:commandButton>
						</p:column>

						<p:column styleClass="action_column" exportable="false">

							<p:commandButton icon="ui-icon pi pi-pencil" update=":form"
                                             style="border: none !important;"
								action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityEditId}" />
							</p:commandButton>
						</p:column>
					</p:dataTable>

					<p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
						icon="fa fa-file-excel-o"
						style="margin-top: 20px;  left: 100%;
                                    transform:translate(-100%, 0);"
						styleClass="grey-button" ajax="false">
						<p:dataExporter type="xls" target="table" fileName="#{list_title}"
							excludeColumns="#{excludeColumns}" />
					</p:commandButton>
				</p:outputPanel>
			</p:tab>
            
            <p:tab title="#{msg.clientManager}">
                <p:outputPanel style="margin-top: 20px;">
                <p:panelGrid columns="3" id="gestorepanel"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
		                <p:column style="width: 10%!important;" >
		                <h:outputText value="#{msg.invoiceClient}:"/>
		                    <p:selectOneMenu id="client" value="#{bean.selectedClientId}"
		                                     label="#{msg.invoiceClient}"
		                                     filter="true"
		                                     filterMatchMode="startsWith" 
		                                     styleClass="select-width">
		                       <p:ajax listener="#{bean.onClientSelect}"
		                                update="managerClientsTable gestorepanel"/>
		                        <f:selectItems value="#{bean.clients}"/>
		                    </p:selectOneMenu>
		                 </p:column> 
		                  <p:column style="width: 10%!important;" rendered="#{bean.selectedClientId > 0}">
		                  <h:outputText value="#{msg.titleOffice}:"/>
		                    <p:selectOneMenu id="office" value="#{bean.selectedClientOfficeId}"
		                                     label="#{msg.titleOffice}:"
		                                     filter="true"
		                                     filterMatchMode="startsWith" 
		                                     styleClass="select-width">
		                           <p:ajax listener="#{bean.onClientOfficeSelect}"
		                                update="managerClientsTable"/>
		                        <f:selectItems value="#{bean.clientOffices}"/>
		                    </p:selectOneMenu>
		                 </p:column> 
                </p:panelGrid>  
                    <p:dataTable var="item" id="managerClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyManagerClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.titleOffice.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.office}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

  						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}" styleClass="red-btn"
                                             icon="ui-icon pi pi-times"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" update=":form"   style="border: none !important;"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            
            <p:tab title="#{msg.clientTypeTrust}">
                <p:outputPanel style="margin-top: 20px;">
	                <p:panelGrid columns="3"
							columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
							styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
			                <p:column style="width: 10%!important;" >
			                <h:outputText value="#{msg.invoiceClient}:"/>
			                    <p:selectOneMenu id="clientTypeTrustDropdown" value="#{bean.selectedClientTrustId}"
			                                     label="#{msg.invoiceClient}"
			                                     filter="true"
			                                     filterMatchMode="startsWith" 
			                                     styleClass="select-width">
			                       <p:ajax listener="#{bean.onClientTrustSelect}"
			                                update="clientTypeTrustTable"/>
			                        <f:selectItems value="#{bean.clients}"/>
			                    </p:selectOneMenu>
			                 </p:column> 
	                </p:panelGrid>  
                    <p:dataTable var="item" id="clientTypeTrustTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyClientTrustModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="clientTypeTrustTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>
						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}"
                                             icon="ui-icon pi pi-times" styleClass="red-btn"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            <p:tab title="#{msg.deletedClients}">
                <p:outputPanel style="margin-top: 20px;">
                    <p:dataTable var="item" id="deletedClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyDeletedClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="deletedClientsTable">

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <p:selectCheckboxMenu value="#{bean.selectedKindList}" label="#{msg.roleType.toUpperCase()}"
                                                      style="background: none !important; border: none !important;">
                                    <f:selectItems value="#{bean.kindList}" var="kind" itemValue="#{kind.value}" itemLabel="#{kind.label}"/>
                                    <p:ajax event="change" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                    <p:ajax event="toggleSelect" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                </p:selectCheckboxMenu>
                            </f:facet>
                            <h:outputText value="#{item.kind}"/>
                        </p:column>

                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            
        </p:tabView>

        <p:dialog header="#{msg.deleteConfirmationHeader}" widgetVar="dlg2" styleClass="dialog-green dialog-green-width"
                  modal="true" resizable="false" effect="SLIDE" style="overflow: unset !important;">
        #{msg.deleteConfirmation}<br/>
            <br/>
            <div class="btn_line">
                <p:commandButton value="#{msg.confirm}" action="#{bean.deleteEntity}" style="margin-right: 10px;background-color: #00CC52!important;"
                                 oncomplete="PF('dlg2').hide()" update=":form, :form:messages"/>
                <p:commandButton value="#{msg.cancel}" onclick="PF('dlg2').hide()" style="background-color: #F3362B !important;"/>
            </div>
        </p:dialog>
    </ui:define>

</ui:composition>
</html>
