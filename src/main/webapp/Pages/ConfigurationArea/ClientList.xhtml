<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/resources/tpl/Admin/LazyListTabBase.xhtml">
    <ui:param name="bean" value="#{clientListBean}"/>
    <ui:param name="list_header" value="#{msg.client}"/>
    <ui:param name="excludeColumns" value="0,1,2"/>
    <ui:param name="page_header" value="#{msg.categoryPercentValueCategoryCode}"/>
    <ui:define name="list_body">
        <style>
            .row {
                display: flex;
                gap: 5%;
            }
            .title-txt {
                font-size: 40px;
                margin-left: 5px;
            }
            .row {
                display: flex;
            }
            #clientType_label {
                font-size: 20px;
            }

            #table_paginator_top, #table_paginator_bottom {
                text-align: center;
                padding-bottom: 4px !important;
                padding: 8px 35px;
            }

            .ui-paginator-rpp-options {
                margin-top: 6px !important;
            }

            .ui-paginator-current {
                margin-top: 2px !important;
            }

            body .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                background: #FFF !important;
                color: #000000 !important;
            }

            #contactTable table, #gestoreTable table, #fiduciaryTable table {
                margin-top: 20px;
                padding-left: 13px;
            }

            body .ui-datatable:not(.borderless) thead th {
                background-color: #D9E0E7 !important;
                border-color: #808080 !important;
                color: #5f666c !important;
                padding: 8px 2px !important;
                border-width: 1px!important;
                border-style: solid!important;
            }


            #contactTable_data td, #gestoreTable_data td, #fiduciaryTable_data td  {
                color: #003871;
                border: none;
                border-bottom: none;
                background-color: #ffffff !important;
            }

            #contactTable_data td:nth-child(1),#gestoreTable_data td:nth-child(1),
            #fiduciaryTable_data td:nth-child {
                border-left: none;
                border-top-left-radius: 5px;
                border-bottom-left-radius: 5px;
            }

            #contactTable_data td:last-child, #gestoreTable_data td:last-child,
            #fiduciaryTable_data td:last-child {
                border-right: none;
                border-top-right-radius: 5px;
                border-bottom-right-radius: 5px;
                -webkit-box-shadow: 4px 0px 7px -2px rgba(0, 0, 0, 0.75);
                -moz-box-shadow: 4px 0px 7px -2px rgba(0, 0, 0, 0.75);
                box-shadow: 4px 0px 7px -2px rgba(0, 0, 0, 0.75);
            }

            #contactTable_data, #gestoreTable_data, #fiduciaryTable_data  {
                border: none;
                background: transparent;
            }

            body .ui-widget, body .ui-widget .ui-widget {
                font-weight: 400 !important;
            }

            body #contactTable_head th, body #gestoreTable_head th,
            #fiduciaryTable_head th{
                background-color: #CCCCCC !important;
            }

            body #contactTable_head th, body #gestoreTable_head th,  #fiduciaryTable_head th ,.table-client-list span.ui-column-title {
                color: #000 !important;
            }

            .action_column {
                width: 50px;
            }

            body .ui-button.ui-button-warning-icon, body .ui-splitbutton.ui-button-warning-icon > .ui-button {
                background: #fb6e51;
                color: #FFFFFF;
                border: 1px solid #fb6e51 !important;
            }

            body .ui-button.ui-button-warning-icon.ui-state-focus, body .ui-splitbutton.ui-button-warning-icon > .ui-button.ui-state-focus {
                box-shadow: 0 0 0 0.2rem orange !important;
            }

            body .ui-button.ui-button-warning-icon.ui-state-active, body .ui-splitbutton.ui-button-warning-icon.ui-state-active > .ui-button.ui-state-active {
                background-color: #ff8b00 !important;
                color: #FFFFFF;
                border: 1px solid #ff8b00 !important;
            }
        </style>
        <link href="#{facesContext.externalContext.requestContextPath}/resources/styles/client.css"
              media="all" rel="stylesheet" type="text/css"/>
        <div class="row title-txt">

            <h:outputText value=" #{msg.clients}" rendered="#{bean.tab eq 1}"/>
            <h:outputText value=" #{msg.requestManagers}" rendered="#{bean.tab eq 2}"/>
            <h:outputText value=" #{msg.requestTrustees}" rendered="#{bean.tab eq 3}"/>
        </div>

        <p:panelGrid styleClass="ui-panelgrid-blank form-group fiend-panel" style="width: 100%"
                     rendered="#{bean.tab eq null}">
            <p:row>
                <p:column style="width: 20%!important;">
                    <p:inputText value="#{bean.nameOfTheCompany}" placeholder="#{msg.clientShortNameOfTheCompany}"
                                 maxlength="100"
                                 styleClass="input-width"
                                 id="nameOfTheCompany" label="#{msg.clientShortNameOfTheCompany}"/>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:inputText value="#{bean.numberVAT}" maxlength="11" placeholder="#{msg.clientVATNumber}"
                                 id="numberVAT" styleClass="input-width"
                                 label="#{msg.clientVATNumber}"/>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:selectOneMenu id="province" value="#{bean.addressProvinceId}"
                                     label="#{msg.clientAddressProvince}"
                                     styleClass="selectOneLabel">
                        <p:ajax update="province, city, country"
                                listener="#{clientListBean.handleAddressProvinceChange}"/>
                        <f:selectItems value="#{bean.provinces}"/>
                    </p:selectOneMenu>
                </p:column>
                <p:column style="width: 20%!important;">
                    <p:selectOneMenu id="city" value="#{bean.addressCityId}" styleClass="selectOneLabel"
                                     style="display: #{bean.foreignCountry ? 'none' : ''};"
                                     label="#{msg.clientAddressCity}">
                        <f:selectItems value="#{bean.addressCities}"/>
                    </p:selectOneMenu>

                    <p:selectOneMenu id="country" value="#{bean.selectedCountryId}" styleClass="selectOneLabel"
                                     style="display: #{bean.foreignCountry ? '' : 'none'};"
                                     label="#{msg.databaseListSubjectCity}:">
                        <f:selectItems value="#{bean.countries}"/>
                    </p:selectOneMenu>
                </p:column>
                <p:column style="width: 1%!important;">
                    <p:commandButton value="#{msg.search.toUpperCase()}" styleClass="grey-button right-side"
                                     action="#{bean.searchClients}" update=":form:tabs"/>
                </p:column>
            </p:row>
        </p:panelGrid>

        <div class="p-grid">
            <div class="p-col-6">
                <div class="p-formgroup-inline">
                    <div class="p-field">
                        <p:commandButton disabled="#{!bean.canCreate}" styleClass="green-button"
                                         value="#{msg.newClient.toUpperCase()}"
                                         action="#{bean.addEntity}" style="#{bean.tab ne null ? 'margin-top:20px' : ''}"/>
                    </div>
                </div>
            </div>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 1}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu id="contactClientType" value="#{bean.selectedClientTypeId}" style="border: 2px solid #ced4da;"
                                         styleClass="select-width" label="#{msg.clientType}" placeholder="#{msg.clientType}">
                            <p:ajax update="@this"/>
                            <f:selectItems value="#{bean.clientTypes}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:inputText value="#{bean.nameOfTheCompany}"
                                     maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"
                                     id="contactNameOfTheCompany" label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon"
                                         action="#{bean.searchClients}"
                                         update="contactTable"/>
                    </div>
                </div>
            </p:outputPanel>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 2}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu value="#{bean.selectedClientId}"
                                         label="#{msg.invoiceClient}"
                                         filter="true" placeholder="#{msg.client}"
                                         filterMatchMode="startsWith"
                                         styleClass="select-width">
                            <p:ajax listener="#{bean.onClientSelect}"
                                    update="@this"/>
                            <f:selectItems value="#{bean.clients}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:inputText value="#{bean.nameOfTheCompany}"
                                     maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"  label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon" action="#{bean.searchClients}" update="gestoreTable"/>
                    </div>
                </div>
            </p:outputPanel>
            <p:outputPanel styleClass="p-col-6" rendered="#{bean.tab eq 3}">
                <div class="p-formgroup-inline alignEnd">
                    <div class="p-field">
                        <p:selectOneMenu value="#{bean.selectedClientId}"
                                         label="#{msg.invoiceClient}"
                                         filter="true" placeholder="#{msg.client}"
                                         filterMatchMode="startsWith"
                                         styleClass="select-width">
                            <p:ajax listener="#{bean.onClientSelect}"
                                    update="@this"/>
                            <f:selectItems value="#{bean.clients}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:inputText value="#{bean.nameOfTheCompany}"
                                     maxlength="100" placeholder="Denominazione"
                                     styleClass="input-width"  label="#{msg.clientShortNameOfTheCompany}"/>
                    </div>

                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon" action="#{bean.searchClients}" update="fiduciaryTable"/>
                    </div>
                </div>
            </p:outputPanel>
        </div>
        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 1}">
            <p:outputPanel style="margin-top: 20px;">
                <p:dataTable var="item" id="contactTable" styleClass="table-client-list"
                             emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyModel}"
                             paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                             paginatorAlwaysVisible="true"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,20,50" widgetVar="table">
                    <p:column sortBy="#{item.clientName}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{msg.clientNameOfTheCompany.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientAddressCity.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item.addressCityId}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientMail.toUpperCase()}" />
                        </f:facet>
                        <!-- <h:outputText value="#{item.emails}"/> -->
                        <ui:repeat value="#{item.emails}" var="email">
                            <h:outputText value="#{email.email}" />
                            <h:outputText value="&lt;br /&gt;" escape="false" />
                        </ui:repeat>
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientPhone.toUpperCase()}" />
                        </f:facet>
                        <h:outputText value="#{item.phone}" />
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <p:selectCheckboxMenu value="#{bean.selectedKindList}"
                                                  label="#{msg.roleType.toUpperCase()}"
                                                  style="background: none !important; border: none !important;">
                                <f:selectItems value="#{bean.kindList}" var="kind"
                                               itemValue="#{kind.value}" itemLabel="#{kind.label}" />
                                <p:ajax event="change" listener="#{bean.searchClients}"
                                        update="contactTable" />
                                <p:ajax event="toggleSelect" listener="#{bean.searchClients}"
                                        update="contactTable" />
                            </p:selectCheckboxMenu>
                        </f:facet>
                        <h:outputText value="#{item.kind}" />
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton disabled="#{!bean.canDelete}"
                                         styleClass="red-btn"
                                         icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityDeleteId}" />
                        </p:commandButton>
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                         action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>

                    <p:column styleClass="action_column" exportable="false">

                        <p:commandButton icon="ui-icon pi pi-pencil" update=":form"
                                         style="border: none !important;"
                                         action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}" />
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

                <p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
                                 icon="fa fa-file-excel-o"
                                 style="margin-top: 20px;  left: 100%;
                                    transform:translate(-100%, 0);"
                                 styleClass="grey-button" ajax="false">
                    <p:dataExporter type="xls" target="table" fileName="#{list_title}"
                                    excludeColumns="#{excludeColumns}" />
                </p:commandButton>
            </p:outputPanel>
        </p:outputPanel>

        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 2}">
        <p:outputPanel style="margin-top: 20px;">
            <p:dataTable var="item" id="gestoreTable"
                         styleClass="table-client-list"
                         emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyManagerClientModel}"
                         paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                         paginatorAlwaysVisible="true"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                <p:column sortBy="#{item.clientName}">
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="#{msg.titleOffice.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item.office}"/>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                    </f:facet>
                    <!-- <h:outputText value="#{item.emails}"/> -->
                    <ui:repeat value="#{item.emails}" var="email">
                        <h:outputText value="#{email.email}"/>
                        <h:outputText value="&lt;br /&gt;" escape="false"/>
                    </ui:repeat>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                    </f:facet>
                    <h:outputText value="#{item.phone}"/>
                </p:column>

                <p:column >
                    <f:facet name="header">
                        <h:outputText value="#{msg.client}"/>
                    </f:facet>
                    <h:outputText value="#{item.clients}"/>
                </p:column>
                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton disabled="#{!bean.canDelete}" styleClass="red-btn"
                                     icon="ui-icon pi pi-times"
                                     oncomplete="PF('dlg2').show()">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityDeleteId}"/>
                    </p:commandButton>
                </p:column>

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                     action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityEditId}"/>
                    </p:commandButton>
                </p:column>

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon pi pi-pencil" update=":form"   style="border: none !important;"
                                     action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.entityEditId}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>

        </p:outputPanel>
        </p:outputPanel>

        <p:outputPanel style="margin-top: 20px;" rendered="#{bean.tab eq 3}">
            <p:outputPanel style="margin-top: 20px;">
                <p:dataTable var="item" id="fiduciaryTable"
                             styleClass="table-client-list"
                             emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyClientTrustModel}"
                             paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                             paginatorAlwaysVisible="true"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                    <p:column sortBy="#{item.clientName}">
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item}"/>
                    </p:column>

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item.addressCityId}"/>
                    </p:column>

                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                        </f:facet>
                        <!-- <h:outputText value="#{item.emails}"/> -->
                        <ui:repeat value="#{item.emails}" var="email">
                            <h:outputText value="#{email.email}"/>
                            <h:outputText value="&lt;br /&gt;" escape="false"/>
                        </ui:repeat>
                    </p:column>

                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                        </f:facet>
                        <h:outputText value="#{item.phone}"/>
                    </p:column>
                    <p:column >
                        <f:facet name="header">
                            <h:outputText value="#{msg.client}"/>
                        </f:facet>
                        <h:outputText value="#{item.clients}"/>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton disabled="#{!bean.canDelete}"
                                         icon="ui-icon pi pi-times" styleClass="red-btn"
                                         oncomplete="PF('dlg2').show()">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityDeleteId}"/>
                        </p:commandButton>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search"
                                         action="#{bean.viewEntity}" disabled="#{!bean.canView}" update=":form">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>
                    <p:column styleClass="action_column" exportable="false">
                        <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                         action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                            <f:setPropertyActionListener value="#{item.id}"
                                                         target="#{bean.entityEditId}"/>
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

            </p:outputPanel>
        </p:outputPanel>
        <p:tabView dynamic="true" cache="true" id="tabs" activeIndex="#{bean.activeClientListIndex}" rendered="#{bean.tab eq null}">
            <p:ajax event="tabChange" listener="#{bean.onTabChange}"/>
            <p:tab title="#{msg.clients}">
				<p:outputPanel style="margin-top: 20px;">
					<p:panelGrid columns="3"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
						<p:column style="width: 10%!important;">
							<h:outputText value="#{msg.clientType}:" />
							<p:selectOneMenu id="clientType" value="#{bean.selectedClientTypeId}" 
								styleClass="select-width" label="#{msg.clientType}">
								<p:ajax listener="#{bean.searchClients}" update="table" />
                                <f:selectItems value="#{bean.clientTypes}"/>
                            </p:selectOneMenu>
						</p:column>
					</p:panelGrid>
					<p:dataTable var="item" id="table" styleClass="table-client-list"
						emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyModel}"
						paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
						paginatorAlwaysVisible="true"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						rowsPerPageTemplate="10,20,50" widgetVar="table">

						<p:column sortBy="#{item.clientName}"
							filterBy="#{item.clientName}">
							<f:facet name="header">
								<h:outputText
									value="#{msg.clientNameOfTheCompany.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientAddressCity.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.addressCityId}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientMail.toUpperCase()}" />
							</f:facet>
							<!-- <h:outputText value="#{item.emails}"/> -->
							<ui:repeat value="#{item.emails}" var="email">
								<h:outputText value="#{email.email}" />
								<h:outputText value="&lt;br /&gt;" escape="false" />
							</ui:repeat>
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientPhone.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.phone}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<p:selectCheckboxMenu value="#{bean.selectedKindList}"
									label="#{msg.roleType.toUpperCase()}"
									style="background: none !important; border: none !important;">
									<f:selectItems value="#{bean.kindList}" var="kind"
										itemValue="#{kind.value}" itemLabel="#{kind.label}" />
									<p:ajax event="change" listener="#{bean.searchClients}"
										update="table" />
									<p:ajax event="toggleSelect" listener="#{bean.searchClients}"
										update="table" />
								</p:selectCheckboxMenu>
							</f:facet>
							<h:outputText value="#{item.kind}" />
						</p:column>

						<p:column styleClass="action_column" exportable="false">
							<p:commandButton disabled="#{!bean.canDelete}"
                                             styleClass="red-btn"
                                             icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityDeleteId}" />
							</p:commandButton>
						</p:column>

						<p:column styleClass="action_column" exportable="false">

							<p:commandButton icon="ui-icon pi pi-pencil" update=":form"
                                             style="border: none !important;"
								action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityEditId}" />
							</p:commandButton>
						</p:column>
					</p:dataTable>

					<p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
						icon="fa fa-file-excel-o"
						style="margin-top: 20px;  left: 100%;
                                    transform:translate(-100%, 0);"
						styleClass="grey-button" ajax="false">
						<p:dataExporter type="xls" target="table" fileName="#{list_title}"
							excludeColumns="#{excludeColumns}" />
					</p:commandButton>
				</p:outputPanel>
			</p:tab>
            
            <p:tab title="#{msg.clientManager}">
                <p:outputPanel style="margin-top: 20px;">
                <p:panelGrid columns="3" id="gestorepanel"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
		                <p:column style="width: 10%!important;" >
		                <h:outputText value="#{msg.invoiceClient}:"/>
		                    <p:selectOneMenu id="client" value="#{bean.selectedClientId}"
		                                     label="#{msg.invoiceClient}"
		                                     filter="true"
		                                     filterMatchMode="startsWith" 
		                                     styleClass="select-width">
		                       <p:ajax listener="#{bean.onClientSelect}"
		                                update="managerClientsTable gestorepanel"/>
		                        <f:selectItems value="#{bean.clients}"/>
		                    </p:selectOneMenu>
		                 </p:column> 
		                  <p:column style="width: 10%!important;" rendered="#{bean.selectedClientId > 0}">
		                  <h:outputText value="#{msg.titleOffice}:"/>
		                    <p:selectOneMenu id="office" value="#{bean.selectedClientOfficeId}"
		                                     label="#{msg.titleOffice}:"
		                                     filter="true"
		                                     filterMatchMode="startsWith" 
		                                     styleClass="select-width">
		                           <p:ajax listener="#{bean.onClientOfficeSelect}"
		                                update="managerClientsTable"/>
		                        <f:selectItems value="#{bean.clientOffices}"/>
		                    </p:selectOneMenu>
		                 </p:column> 
                </p:panelGrid>  
                    <p:dataTable var="item" id="managerClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyManagerClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.titleOffice.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.office}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

  						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}" styleClass="red-btn"
                                             icon="ui-icon pi pi-times"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" update=":form"   style="border: none !important;"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            
            <p:tab title="#{msg.clientTypeTrust}">
                <p:outputPanel style="margin-top: 20px;">
	                <p:panelGrid columns="3"
							columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
							styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
			                <p:column style="width: 10%!important;" >
			                <h:outputText value="#{msg.invoiceClient}:"/>
			                    <p:selectOneMenu id="clientTypeTrustDropdown" value="#{bean.selectedClientTrustId}"
			                                     label="#{msg.invoiceClient}"
			                                     filter="true"
			                                     filterMatchMode="startsWith" 
			                                     styleClass="select-width">
			                       <p:ajax listener="#{bean.onClientTrustSelect}"
			                                update="clientTypeTrustTable"/>
			                        <f:selectItems value="#{bean.clients}"/>
			                    </p:selectOneMenu>
			                 </p:column> 
	                </p:panelGrid>  
                    <p:dataTable var="item" id="clientTypeTrustTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyClientTrustModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="clientTypeTrustTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>
						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}"
                                             icon="ui-icon pi pi-times" styleClass="red-btn"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            <p:tab title="#{msg.deletedClients}">
                <p:outputPanel style="margin-top: 20px;">
                    <p:dataTable var="item" id="deletedClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyDeletedClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="deletedClientsTable">

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <p:selectCheckboxMenu value="#{bean.selectedKindList}" label="#{msg.roleType.toUpperCase()}"
                                                      style="background: none !important; border: none !important;">
                                    <f:selectItems value="#{bean.kindList}" var="kind" itemValue="#{kind.value}" itemLabel="#{kind.label}"/>
                                    <p:ajax event="change" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                    <p:ajax event="toggleSelect" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                </p:selectCheckboxMenu>
                            </f:facet>
                            <h:outputText value="#{item.kind}"/>
                        </p:column>

                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            
        </p:tabView>

        <p:dialog header="#{msg.deleteConfirmationHeader}" widgetVar="dlg2"
                  modal="true" resizable="false" effect="SLIDE">
            #{msg.deleteConfirmation}<br/>
            <br/>
            <div class="btn_line">
                <p:commandButton value="#{msg.confirm}" action="#{bean.deleteEntity}" style="margin-right: 10px;background-color: #00CC52!important;"
                                 oncomplete="PF('dlg2').hide()" update=":form, :form:messages"/>
                <p:commandButton value="#{msg.cancel}" onclick="PF('dlg2').hide()" style="background-color: #F3362B !important;"/>
            </div>
        </p:dialog>
    </ui:define>

</ui:composition>
</html>
