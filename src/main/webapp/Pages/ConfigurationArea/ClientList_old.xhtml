<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/resources/tpl/Admin/LazyListTabBase.xhtml">
    <ui:param name="bean" value="#{clientListBean}"/>
    <ui:param name="list_header" value="#{msg.client}"/>
    <ui:param name="excludeColumns" value="0,1,2"/>
    <ui:define name="list_body">
        <link href="#{facesContext.externalContext.requestContextPath}/resources/styles/client.css"
              media="all" rel="stylesheet" type="text/css"/>
        <div class="">
            <div class="">
                #{msg.clients}
            </div>
            <div class="">
                #{msg.clients}
            </div>
            <div class="">
                #{msg.clients}
            </div>
            <div class="">
                #{msg.clients}
            </div>

        </div>
        <p:tabView dynamic="true" cache="true" id="tabs" activeIndex="#{bean.activeClientListIndex}">
            <p:ajax event="tabChange" listener="#{bean.onTabChange}"/>
            <p:tab title="#{msg.clients}">
				<p:outputPanel style="margin-top: 20px;">
					<p:panelGrid columns="3"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
						<p:column style="width: 10%!important;">
							<h:outputText value="#{msg.clientType}:" />
							<p:selectOneMenu id="clientType" value="#{bean.selectedClientTypeId}"
								styleClass="select-width" label="#{msg.clientType}">
								<p:ajax listener="#{bean.searchClients}" update="table" />
                                <f:selectItems value="#{bean.clientTypes}"/>
                            </p:selectOneMenu>
						</p:column>
					</p:panelGrid>
					<p:dataTable var="item" id="table" styleClass="table-client-list"
						emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyModel}"
						paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
						paginatorAlwaysVisible="true"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						rowsPerPageTemplate="10,20,50" widgetVar="table">

						<p:column sortBy="#{item.clientName}"
							filterBy="#{item.clientName}">
							<f:facet name="header">
								<h:outputText
									value="#{msg.clientNameOfTheCompany.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientAddressCity.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.addressCityId}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientMail.toUpperCase()}" />
							</f:facet>
							<!-- <h:outputText value="#{item.emails}"/> -->
							<ui:repeat value="#{item.emails}" var="email">
								<h:outputText value="#{email.email}" />
								<h:outputText value="&lt;br /&gt;" escape="false" />
							</ui:repeat>
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg.clientPhone.toUpperCase()}" />
							</f:facet>
							<h:outputText value="#{item.phone}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<p:selectCheckboxMenu value="#{bean.selectedKindList}"
									label="#{msg.roleType.toUpperCase()}"
									style="background: none !important; border: none !important;">
									<f:selectItems value="#{bean.kindList}" var="kind"
										itemValue="#{kind.value}" itemLabel="#{kind.label}" />
									<p:ajax event="change" listener="#{bean.searchClients}"
										update="table" />
									<p:ajax event="toggleSelect" listener="#{bean.searchClients}"
										update="table" />
								</p:selectCheckboxMenu>
							</f:facet>
							<h:outputText value="#{item.kind}" />
						</p:column>

						<p:column styleClass="action_column" exportable="false">
							<p:commandButton disabled="#{!bean.canDelete}"
                                             styleClass="red-btn"
                                             icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityDeleteId}" />
							</p:commandButton>
						</p:column>

						<p:column styleClass="action_column" exportable="false">

							<p:commandButton icon="ui-icon pi pi-pencil" update=":form"
                                             style="border: none !important;"
								action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
								<f:setPropertyActionListener value="#{item.id}"
									target="#{bean.entityEditId}" />
							</p:commandButton>
						</p:column>
					</p:dataTable>

					<p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
						icon="fa fa-file-excel-o"
						style="margin-top: 20px;  left: 100%;
                                    transform:translate(-100%, 0);"
						styleClass="grey-button" ajax="false">
						<p:dataExporter type="xls" target="table" fileName="#{list_title}"
							excludeColumns="#{excludeColumns}" />
					</p:commandButton>
				</p:outputPanel>
			</p:tab>

            <p:tab title="#{msg.clientManager}">
                <p:outputPanel style="margin-top: 20px;">
                <p:panelGrid columns="3" id="gestorepanel"
						columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
						styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
		                <p:column style="width: 10%!important;" >
		                <h:outputText value="#{msg.invoiceClient}:"/>
		                    <p:selectOneMenu id="client" value="#{bean.selectedClientId}"
		                                     label="#{msg.invoiceClient}"
		                                     filter="true"
		                                     filterMatchMode="startsWith"
		                                     styleClass="select-width">
		                       <p:ajax listener="#{bean.onClientSelect}"
		                                update="managerClientsTable gestorepanel"/>
		                        <f:selectItems value="#{bean.clients}"/>
		                    </p:selectOneMenu>
		                 </p:column>
		                  <p:column style="width: 10%!important;" rendered="#{bean.selectedClientId > 0}">
		                  <h:outputText value="#{msg.titleOffice}:"/>
		                    <p:selectOneMenu id="office" value="#{bean.selectedClientOfficeId}"
		                                     label="#{msg.titleOffice}:"
		                                     filter="true"
		                                     filterMatchMode="startsWith"
		                                     styleClass="select-width">
		                           <p:ajax listener="#{bean.onClientOfficeSelect}"
		                                update="managerClientsTable"/>
		                        <f:selectItems value="#{bean.clientOffices}"/>
		                    </p:selectOneMenu>
		                 </p:column>
                </p:panelGrid>
                    <p:dataTable var="item" id="managerClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyManagerClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="managerClientsTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.titleOffice.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.office}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

  						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}" styleClass="red-btn"
                                             icon="ui-icon pi pi-times"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" update=":form"   style="border: none !important;"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>

            <p:tab title="#{msg.clientTypeTrust}">
                <p:outputPanel style="margin-top: 20px;">
	                <p:panelGrid columns="3"
							columnClasses="ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3,ui-g-12 ui-md-3"
							styleClass="ui-panelgrid-blank ui-fluid" layout="grid">
			                <p:column style="width: 10%!important;" >
			                <h:outputText value="#{msg.invoiceClient}:"/>
			                    <p:selectOneMenu id="clientTypeTrustDropdown" value="#{bean.selectedClientTrustId}"
			                                     label="#{msg.invoiceClient}"
			                                     filter="true"
			                                     filterMatchMode="startsWith"
			                                     styleClass="select-width">
			                       <p:ajax listener="#{bean.onClientTrustSelect}"
			                                update="clientTypeTrustTable"/>
			                        <f:selectItems value="#{bean.clients}"/>
			                    </p:selectOneMenu>
			                 </p:column>
	                </p:panelGrid>
                    <p:dataTable var="item" id="clientTypeTrustTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyClientTrustModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="clientTypeTrustTable">

                        <p:column sortBy="#{item.clientName}" filterBy="#{item.clientName}">
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>
						<p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.client}"/>
                            </f:facet>
                            <h:outputText value="#{item.clients}"/>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton disabled="#{!bean.canDelete}"
                                             icon="ui-icon pi pi-times" styleClass="red-btn"
                                             oncomplete="PF('dlg2').show()">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityDeleteId}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>
            <p:tab title="#{msg.deletedClients}">
                <p:outputPanel style="margin-top: 20px;">
                    <p:dataTable var="item" id="deletedClientsTable"
                                 styleClass="table-client-list"
                                 emptyMessage="#{msg.noRecordsFound}" value="#{bean.lazyDeletedClientModel}"
                                 paginator="true" lazy="true" rowKey="#{item.id}" rows="10"
                                 paginatorAlwaysVisible="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,20,50" widgetVar="deletedClientsTable">

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientNameOfTheCompany.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientAddressCity.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.addressCityId}"/>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientMail.toUpperCase()}"/>
                            </f:facet>
                            <!-- <h:outputText value="#{item.emails}"/> -->
                            <ui:repeat value="#{item.emails}" var="email">
                                <h:outputText value="#{email.email}"/>
                                <h:outputText value="&lt;br /&gt;" escape="false"/>
                            </ui:repeat>
                        </p:column>

                        <p:column >
                            <f:facet name="header">
                                <h:outputText value="#{msg.clientPhone.toUpperCase()}"/>
                            </f:facet>
                            <h:outputText value="#{item.phone}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <p:selectCheckboxMenu value="#{bean.selectedKindList}" label="#{msg.roleType.toUpperCase()}"
                                                      style="background: none !important; border: none !important;">
                                    <f:selectItems value="#{bean.kindList}" var="kind" itemValue="#{kind.value}" itemLabel="#{kind.label}"/>
                                    <p:ajax event="change" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                    <p:ajax event="toggleSelect" listener="#{bean.searchClients}" update="deletedClientsTable"/>
                                </p:selectCheckboxMenu>
                            </f:facet>
                            <h:outputText value="#{item.kind}"/>
                        </p:column>

                        <p:column styleClass="action_column" exportable="false">
                            <p:commandButton icon="ui-icon pi pi-pencil" style="border: none !important;" update=":form"
                                             action="#{bean.editEntity}" disabled="#{!bean.canEdit}">
                                <f:setPropertyActionListener value="#{item.id}"
                                                             target="#{bean.entityEditId}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                </p:outputPanel>
            </p:tab>

        </p:tabView>

        <p:dialog header="#{msg.deleteConfirmationHeader}" widgetVar="dlg2"
                  modal="true" resizable="false" effect="SLIDE">
            #{msg.deleteConfirmation}<br/>
            <br/>
            <div class="btn_line">
                <p:commandButton value="#{msg.confirm}" action="#{bean.deleteEntity}" style="margin-right: 10px;background-color: #00CC52!important;"
                                 oncomplete="PF('dlg2').hide()" update=":form, :form:messages"/>
                <p:commandButton value="#{msg.cancel}" onclick="PF('dlg2').hide()" style="background-color: #F3362B !important;"/>
            </div>
        </p:dialog>
    </ui:define>

</ui:composition>
</html>
