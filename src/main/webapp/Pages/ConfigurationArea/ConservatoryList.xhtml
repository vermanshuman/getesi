<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
	  xmlns:ff="http://readytech.com/functions">

<ui:composition template="/resources/tpl/Admin/LazyListTabBase.xhtml">
    <ui:param name="bean" value="#{conservatoryListBean}"/>
    <ui:param name="list_header" value="#{msg.conservatoryList}"/>
    <ui:param name="excludeColumns" value="0,1,2"/>
    <ui:param name="page_header" value="#{msg.categoryPercentValueCategoryCode}"/>
    <ui:define name="list_body">
        <style>
            .row {
                display: flex;
                gap: 5%;
            }
            .title-txt {
                font-size: 40px;
                margin-left: 5px;
            }
            .row {
                display: flex;
            }
            body .ui-panel .ui-panel-content {
                border: none !important;
            }

            body .ui-datatable .ui-paginator.ui-paginator-top {
                background-color: #788FA7 !important;
                color: #ffffff !important;
            }
            .mail-button {
                background: #00CC52 !important;
            }

            .searchPanelButton {
                background: #fb6e51 !important;
            }
            .cartelle-btn {
                background:  #ff8b00 !important;
            }
            .ui-chkbox.ui-chkbox-all.ui-widget {
                display: none;
            }

            .table-demo {
                margin-right: 0rem;
                margin-left: 0rem;
                margin-top: 0rem;
            }

            body .ui-datatable .ui-datatable-data tr.ui-datatable-even {
                background-color: #f0f3f5 !important;
            }

            .ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td, .ui-datatable tfoot th {
                border: 1px solid #c9cdd2 !important;
            }

            .ui-datatable tbody td, .ui-datatable tfoot td {
                border-width: 0 1px 1px 0 !important;
            }

            body .ui-datatable #conservatoryTable_head th, body .ui-datatable #gestoreTable_head th,
            body .ui-datatable #fiduciaryTable_head th {
                background-color: #f8f9fa !important;
                color: #495057 !important;
            }

            body .ui-datatable #conservatoryTable_head th .ui-column-title, body .ui-datatable #gestoreTable_head th .ui-column-title,
            body .ui-datatable #fiduciaryTable_head th .ui-column-title {
                color: #5f666c !important;
            }

            body .ui-datatable .ui-datatable-data tr td {
                padding: 6px 6px !important;
            }

            body .table-client-list.ui-datatable #conservatoryTable_data tr td, body .table-client-list.ui-datatable #gestoreTable_data tr td,
            body .table-client-list.ui-datatable #fiduciaryTable_data tr td {
                color: #4c5156 !important;
            }

            body .ui-datatable thead th.ui-state-active {
                color: #2196F3 !important;
            }

            body .ui-datatable .ui-datatable-data > tr:hover {
                background: #e9ecef !important;
            }

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-pages .ui-paginator-page, body .ui-paginator .ui-paginator-first, body .ui-paginator .ui-paginator-prev, body .ui-paginator .ui-paginator-next, body .ui-paginator .ui-paginator-last {
                color: #6c757d !important;
            }

            body .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                background: #2196F3 !important;
                color: #ffffff !important;
            }
            .table-demo .p-col-12, .table-demo .card {
                padding: 0;
                border: none;
            }
            .ui-datatable-gridlines.td {
                border-width: 1px !important;
            }

            body .ui-datatable .ui-datatable-header {
                border-top: 2px solid #c9cdd2 !important;
            }

            .card {
                border: none !important;
                padding-bottom: 0px !important;
                margin-bottom: 0px !important;
                padding-top: 0px !important;
            }

            #table_div_content{
                padding-top: 0px !important;
            }
            .ui-datatable-header {
                padding-top: 5px !important;
                padding-bottom: 5px !important;
            }

            /* body {
                font-family: "cabin", sans-serif !important;
                font-size: 1rem !important;
                text-decoration: none;
            } */

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-pages .ui-paginator-page,
            body .ui-paginator .ui-paginator-first, body .ui-paginator .ui-paginator-prev,
            body .ui-paginator .ui-paginator-next, body .ui-paginator .ui-paginator-last {
                color: #FFFFFF !important;
            }

            body .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                background: #FFF !important;
                color: #000000 !important;
            }


            .layout-wrapper .route-bar {
                border-bottom: 1px solid #c9cdd2;
            }

            .layout-footer {
                border-top: 1px solid #c9cdd2;
            }

            .ui-datatable tbody.ui-datatable-data {
                border-left: 1px solid #c9cdd2;
            }

            body .ui-paginator .ui-paginator-current, body .ui-paginator .ui-paginator-rpp-options {
                margin: 0;
            }
           /*  body .ui-widget, body .ui-widget .ui-widget {
                font-family: "Open Sans","Helvetica Neue",sans-serif !important;
                text-decoration: none !important;
                font-size: 14px !important;
            } */

            #states_panel {
                background: #ffffff;
                color: #495057;
                padding: 0;
                border: 0 none;
                box-shadow: 0px 11px 15px -7px rgb(0 0 0 / 20%), 0px 24px 38px 3px rgb(0 0 0 / 14%), 0px 9px 46px 8px rgb(0 0 0 / 12%);
                border-radius: 4px;
            }

            #states_panel .ui-selectcheckboxmenu-items-wrapper {
                padding: 0px 1rem 1rem 1rem;
            }

            #states_panel .ui-selectcheckboxmenu-header {
                margin: 1rem 1rem 0px 1rem;
                border: 1px solid #808080 ;
                background-color: #D9E0E7 !important;
                color: #000000 !important;
            }

            #states_panel .ui-selectcheckboxmenu-list-item {
                border: 1px solid #c9cdd2;
                border-top: none;
            }

            #states_panel .ui-selectcheckboxmenu-close {
                display: none;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item label {
                color: #295887;
                font-weight: 600;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item {
                border: 1px solid;
            }

            .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-list-item .ui-chkbox .ui-chkbox-box.ui-state-hover {
                border: 2px solid #4D759D;
            }

            body .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-items {
                padding: 0 0;
            }

            body .ui-chkbox .ui-chkbox-box.ui-state-active {
                border-color: #4D759D;
                color: #5f666c !important;
                background-color: transparent !important;
            }

            #filterDateFrom_input {
                width: 160px;
            }

            #filterDateTo_input {
                width: 160px;
            }
            body .ui-datatable thead th {
                border-color: #c9cdd2 !important;
            }

            body .ui-inputfield {
                border: 1px solid #a8acb1;
            }

            body .ui-chkbox .ui-chkbox-box .ui-chkbox-icon.ui-icon-check {
                font-weight: bolder;
            }
            .calender-filled input, .select-checkbox {
                border: 0.2em  solid #57c279 !important;
            }
            body .ui-inputfield.ui-state-focus {
                box-shadow: 0 0 0 0.2em #57c279 !important;
            }

            body .ui-selectcheckboxmenu.ui-state-focus:not(.ui-state-error) {
                box-shadow: 0 0 0 0.2em #57c279 !important;
            }

            .border_class{
                border: 0.2em solid #57c279 !important; border-radius: 7px !important;
            }

            #filterEmailsender.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }

            #filterEmailSubject.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }

            #filterEmailBody.ui-state-focus {
                box-shadow: 0 0 0 0.2em #a6d5fa !important;
            }

			#settingPanel {
				position: absolute;
				z-index: 1;
				margin-top: 10px;
				max-width: 600px;
				right: 33px;
				border: 1px solid #547ac4;
			}

			#settingPanel_content {
				padding: 1rem !important;
			}

			#settingPanel .ui-state-active {
				background-color: #A9A9A9 !important;
				color: #ffffff !important;
			}
        </style>

        <link href="#{facesContext.externalContext.requestContextPath}/resources/styles/client.css" media="all" rel="stylesheet" type="text/css"/>
        <div class="row title-txt">
            <h:outputText value=" #{msg.conservatoryList}" />
        </div>

        <div class="p-grid">
            <div class="p-col-6">
                <div class="p-formgroup-inline">
                    <div class="p-field">
                    </div>
                </div>
            </div>
            <p:outputPanel styleClass="p-col-6">
                <div class="p-formgroup-inline alignEnd">
					<div class="p-field" style="width: 40%;">
					<p:inputText value="#{bean.nameFilter}" maxlength="100" placeholder="#{msg.name}"
                                     styleClass="input-width" id="nameFilter" label="#{msg.name}"/>
                    </div>
<!--					<div class="p-field">-->
<!--						<p:inputText value="#{bean.codeOfficeFilter}" maxlength="100" placeholder="#{msg.code}"-->
<!--                                     styleClass="input-width" id="codeOfficeFilter" label="#{msg.code}"/>-->
<!--					</div>-->
                    <div class="p-field">
                        <p:commandButton icon="ui-icon ui-icon-search pi pi-search" styleClass="ui-button-warning-icon searchPanelButton"
                                         action="#{bean.searchConservatory}" update="conservatoryTable"/>
                    </div>
					<div class="settingsBlock">
						<p:commandButton id="settingButton" onclick="togglePanel();" type="button"
										 icon="ui-icon ui-icon-search pi pi-sliders-h" styleClass="searchPanelButton"/>
						<script type="text/javascript">
							// <![CDATA[
							$("body").click(function(e){
								var target = $(e.target);
								if (!target.parents('#settingButton').length && !target.parents('#settingPanel').length && !target.parents('.ui-selectcheckboxmenu-panel').length
										&& !target.parents('.ui-selectonemenu-items').length && !target.parents('#ui-datepicker-div').length && !target.parents('.ui-datepicker-header').length) {
									PF('panelSetting').getJQ().hide();
								}

							});
							function togglePanel() {
								PF('panelSetting').getJQ().toggle();
							}
							jQuery(document).ready(function() {
								PF('panelSetting').getJQ().hide();
							});
							function closeWindow() {
								console.log("1111111")
								window.close() ;
							}
							// ]]>
						</script>
						<p:panel id="settingPanel" widgetVar="panelSetting" closable="true" toggleable="true" styleClass="panelSetting" style="display: none;">
							<div class="p-grid">
								<div class="p-col-12" style="text-align: center;">
									<h2>Filtra per</h2>
								</div>
								<div class="p-col-6">
									<span style="margin-bottom: 5px;;margin-right: 21px;">#{msg.code}:</span>
									<p:inputText id="filterCode" value="#{bean.filterCode}" placeholder="#{msg.code}" style="width: calc(100% - 80px);"/>
								</div>
								<div class="p-col-6" style="display: flex;">
									<span style="margin-bottom: 5px;margin-right: 21px;margin-top: 8px;">#{msg.type}:</span>
									<p:selectOneMenu value="#{bean.selectedFilterType}" style="width: calc(100% - 80px);"
									id="filterTypes">
										<f:selectItems value="#{bean.filterTypes}"/>
									</p:selectOneMenu>
								</div>
								<div class="p-col-6">
									<span style="margin-bottom: 5px;margin-right: 10px;">#{msg.address}:</span>
									<p:inputText id="filterAddress" value="#{bean.filterAddress}" placeholder="#{msg.address}" style="width: calc(100% - 80px);"/>
								</div>
								<div class="p-col-6">
									<span style="margin-bottom: 5px;margin-right: 10px;">#{msg.email}:</span>
									<p:inputText id="filterEmail" value="#{bean.filterEmail}" placeholder="#{msg.email}" style="width: calc(100% - 80px);"/>
								</div>
								<div class="p-col-8">
									<span style="margin-bottom: 5px;margin-right: 10px;">#{msg.conservatoryPresence}:</span>
									<p:selectBooleanCheckbox id="filterPresence" value="#{bean.referencePresent}"/>
								</div>
								<div class="p-col-12" style="text-align: center;">
									<p:commandButton value="#{ff:upper(msg.requestPrintSelectTemplate)}" style="background: #00CC52;margin-right: 20px;" id="searchButton"
													 onclick="filterTableFromPanel();PF('panelSetting').getJQ().hide()" />
									<p:commandButton id="manageReestablishBtn" value="#{ff:upper(msg.mailManageReestablish)}" action="#{bean.clearFiltraPanel}"
													 update="conservatoryTable settingPanel" onclick="PF('panelSetting').getJQ().hide();"/>
								</div>
							</div>
						</p:panel>
					</div>
                </div>
            </p:outputPanel>
        </div>
		<p:remoteCommand name="filterTableFromPanel"
						 action="#{bean.filterTableFromPanel}" update="conservatoryTable"/>
		<p:remoteCommand name="closePage" action="#{bean.handleCloseDialog}"/>
        <p:outputPanel style="margin-top: 20px;" >
            <p:outputPanel style="margin-top: 20px;">
	            <p:dataTable var="item" id="conservatoryTable" styleClass="table-client-list" emptyMessage="#{msg.noRecordsFound}" value="#{bean.aggregationLandChargesRegistrySet}"
	                             paginator="true" lazy="true" rowKey="#{item.id}" rows="10" paginatorAlwaysVisible="true"
	                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
	                             rowsPerPageTemplate="10,20,50" widgetVar="table">
					<p:column sortBy="#{item.type}">
						<f:facet name="header">
							<h:outputText
									value="#{msg.type.toUpperCase()}" />
						</f:facet>
						<h:outputText value="#{item.type}" />
					</p:column>

					<p:column sortBy="#{item.name}">
		               <f:facet name="header">
		                   <h:outputText
		                           value="#{msg.name.toUpperCase()}" />
		               </f:facet>
		               <h:outputText value="#{item.name}" />
		           </p:column>

		           <p:column>
	                   <f:facet name="header">
	                       <h:outputText value="#{msg.code.toUpperCase()}" />
	                   </f:facet>
	                   <h:outputText value="#{item.codeOffice}" />
	               </p:column>
	
	               <p:column>
	                   <f:facet name="header">
	                       <h:outputText value="#{msg.address.toUpperCase()}" />
	                   </f:facet>
	                   <h:outputText value="#{item.address}" />
	               </p:column>
	
	               <p:column>
	                   <f:facet name="header">
	                       <h:outputText value="#{msg.telephone.toUpperCase()}" />
	                   </f:facet>
	                   <h:outputText value="#{item.phone1}"/> 
	                   <h:outputText value="#{item.phone2 ne null and item.phone2 ne '' ? '/' : ''}"/> 
	                   <h:outputText value="#{item.phone2}"/>
	               </p:column>
	
	               <p:column>
	                   <f:facet name="header">
	                       <h:outputText value="#{msg.email.toUpperCase()}" />
	                   </f:facet>
	                   <h:outputText value="#{item.mail}" />
	               </p:column>
	
	               <p:column>
	                   <f:facet name="header">
	                   	<h:outputText value="#{msg.pec.toUpperCase()}" />
	                   </f:facet>
	                   <h:outputText value="#{item.pec}" />
	               </p:column>
						
				   <p:column styleClass="action_column" exportable="false">
	                   <p:commandButton styleClass="red-btn" icon="ui-icon pi pi-times" oncomplete="PF('dlg2').show()">
	                       <f:setPropertyActionListener value="#{item.id}" target="#{bean.entityDeleteId}" />
	                   </p:commandButton>
		           </p:column>
		
	               <!-- <p:column styleClass="action_column" exportable="false">
	                   <p:commandButton icon="ui-icon ui-icon-search pi pi-search" update=":form">
	                       <f:setPropertyActionListener value="#{item.id}" target="#{bean.entityEditId}"/>
	                   </p:commandButton>
	               </p:column> -->
		
	               <p:column styleClass="action_column" exportable="false">
	                   <p:commandButton icon="ui-icon pi pi-pencil" action="#{bean.editEntity}" style="border: none !important;">
	                       <f:setPropertyActionListener value="#{item.id}" target="#{bean.entityEditId}" />
	                   </p:commandButton>
	               </p:column>
	                    
	         	</p:dataTable>

	            <!-- <p:commandButton value="#{msg.newDownloadExel.toUpperCase()}"
	                             icon="fa fa-file-excel-o"
	                             style="margin-top: 20px;  left: 100%;
	                                transform:translate(-100%, 0);"
	                             styleClass="grey-button" ajax="false">
	                <p:dataExporter type="xls" target="conservatoryTable" fileName="#{list_title}"
	                                excludeColumns="#{excludeColumns}" />
	            </p:commandButton> -->
       		</p:outputPanel>
		</p:outputPanel>

	    <p:dialog header="#{msg.deleteConfirmationHeader}" widgetVar="dlg2" styleClass="dialog-green dialog-green-width"
	                  modal="true" resizable="false" effect="SLIDE" style="overflow: unset !important;">
	        #{msg.deleteConfirmation}<br/>
	         <br/>
	         <div class="btn_line">
	             <p:commandButton value="#{msg.confirm}" action="#{bean.deleteEntity}" style="margin-right: 10px;background-color: #00CC52!important;"
	                              oncomplete="PF('dlg2').hide()" update=":form, :form:messages"/>
	             <p:commandButton value="#{msg.cancel}" onclick="PF('dlg2').hide()" style="background-color: #F3362B !important;"/>
	         </div>
	     </p:dialog>
		
		<p:remoteCommand name="refreshTable" update="@form"/>
		<ui:include src="../Dialogs/ConservatoryDialog.xhtml"/>
	    <!-- <p:dialog widgetVar="addConservatoryDialogWV"  id="addConservatoryDialog" modal="true" draggable="false"
	               width="600" styleClass="dialog-white-bg addPaymentDialog newEntityDialog"
	               position="center center" header="#{msg.estateFormalityConservatory}">
	         <div class="p-grid">
	             <div class="p-col-12 p-md-12">
	                 <div class="card"
	                      style="border: none !important; padding-top:0px; padding-bottom:0px; margin-top:10px;">
	                   <ui:include src="/resources/tpl/common/ValidationMessages.xhtml"/>
	                   <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
	                                columnClasses="ui-grid-col-5,ui-grid-col-7">
	                       <span><span class="red">*</span>#{msg.name}</span>
	                       <p:inputText value="#{bean.entity.name}" id="name" maxlength="50" styleClass="input-width"/>
	
						   <span>#{msg.code}</span>
	                       <p:inputText value="#{bean.entity.codeOffice}" maxlength="3" id="codeOffice" styleClass="input-width">
	                       	   <p:keyFilter regEx="/[a-zA-Z0-9\\s\\' ]+/"/>
	                       </p:inputText>
	                       	
	                       <span>#{msg.address}</span>
	                       <p:inputText value="#{bean.entity.address}" id="address" styleClass="input-width"/>
	                       
	                       <span>#{msg.mainTelephone}</span>
	                       <p:inputText value="#{bean.entity.phone1}" id="phone1" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.secondaryTelephone}</span>
	                       <p:inputText value="#{bean.entity.phone2}" id="phone2" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.email}</span>
	                       <p:inputText value="#{bean.entity.mail}" id="mail" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.pec}</span>
	                       <p:inputText value="#{bean.entity.pec}" id="pec" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.references}</span>
	                       <p:inputText value="#{bean.entity.reference}" id="reference" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.clientCell}</span>
	                       <p:inputText value="#{bean.entity.cellPhone}" id="cellPhone" maxlength="50" styleClass="input-width"/>
	                       
	                       <span>#{msg.stamps}</span>
	                       <p:selectBooleanCheckbox value="#{bean.entity.stamp}" id="stamp"/>
	                       
	                       <span>#{msg.penalty}</span>
	                        <p:selectBooleanCheckbox value="#{bean.entity.penalty}" id="penalty"/>
	                       
	                       <span>#{msg.note}</span>
	                       <p:inputText value="#{bean.entity.note}" id="note" styleClass="input-width"/>
	
	                   </p:panelGrid>
	                   <div class="p-col-12" style="text-align:center;">
	                       <p:commandButton value="#{msg.save.toUpperCase()}" style="margin-left:15px;"
	                                        action="#{bean.save}" update="validationMessages"
	                                        styleClass="ui-button-success p-mr-2 p-mb-2"/>
	                       <p:commandButton oncomplete="PF('addConservatoryDialogWV').hide();"
	                                        value="#{msg.undo.toUpperCase()}" style="background-color: #F3362B !important;"
	                                        action="#{bean.resetFields}"/>
	                   </div>
	               </div>
	           </div>
	       </div>
	   </p:dialog> -->
   </ui:define>
</ui:composition>
</html>
