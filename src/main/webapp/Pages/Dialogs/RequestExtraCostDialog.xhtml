<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:c="http://java.sun.com/jsp/jstl/core">
    <p:dialog widgetVar="requestExtraCostDlg" modal="true" width="600" id="requestExtraCostDialog">
        <div class="cost_titles">
            <c:if test="#{bean.costManipulationHelper.isEditable()}">
                <p:panelGrid rendered="#{bean.examRequest!=null}" columns="2" columnClasses="cost_form_column"
                             styleClass="ui-panelgrid-blank form-group cost_titles_table">
                    <h3>#{msg.estateSituationEditClientName}</h3>
                    <h:outputText styleClass="bold_text" value="#{bean.examRequest.clientName}"/>
                    <h3>#{msg.estateSituationEditRequestType}</h3>
                    <h:outputText styleClass="bold_text" value="#{bean.examRequest.serviceName}"/>
                    <h3>#{msg.requestTextEditNumberFormalities}</h3>
                    <p:inputText value="#{bean.costManipulationHelper.numberActOrSumOfEstateFormalitiesAndOtherTemp}"
                                   onkeypress="return numbers_only(this, event, 9, 0)" onkeyup="check_numbers(this, 9, 0);">
                        <p:ajax event="change" listener="#{bean.updateCosts()}"/>
                    </p:inputText>
                    <c:if test="#{bean.examRequest.showAuthorizedQuote()}">
	                	<h3>#{msg.requestTextEditAuthorizedEstimate}</h3>
			        	<p:selectBooleanCheckbox id="authorizedEstimate" value="#{bean.examRequest.authorizedQuote}"/>
		        	</c:if>
                    <h3>#{msg.requestTextEditNumberSummaryList}</h3>
                    <h:outputText value="#{bean.examRequest.numberOfGroupsByDocumentOfEstateFormality}"/>
                    <h3>#{msg.requestTextEditMortgageExpenses}</h3>
                    <p:inputNumber value="#{bean.costManipulationHelper.costEstateFormalityTemp}"/>
                    <h3>#{msg.requestTextEditLandRegistryFees}</h3>
                    <p:inputNumber value="#{bean.costManipulationHelper.costCadastralTemp}"/>
                    <h3>#{msg.requestTextEditCompensation}</h3>
                    <p:inputNumber value="#{bean.costManipulationHelper.costPayTemp}"/>
                     <h3>#{msg.requestTaxableCost}</h3>
                    <p:inputNumber id="requestTaxableCost" value="#{bean.costManipulationHelper.taxableCostTemp}"/>
                    <h3>#{msg.requestIncludeNationalCost} </h3>
                     <p:selectBooleanCheckbox id="includeNationalCost" value="#{bean.costManipulationHelper.includeNationalCost}">
                     	<p:ajax listener="#{bean.updateNationalCost()}" update="@this requestExtraCostTable includeNationalCostDialog"/>
                     </p:selectBooleanCheckbox>
                    <h3>#{msg.requestExtraCostInit}</h3>
                    <p:inputNumber id="requestExtraCostInit" value="#{bean.costManipulationHelper.initCostTemp}"/>
                    <c:if test="#{bean.hideExtraCost ne null and bean.hideExtraCost}">
                    	<h3>#{msg.requestCostNote}</h3> 
            			<p:inputText value="#{bean.costNote}"/>
                    </c:if>
                </p:panelGrid>
            </c:if>
            <c:if test="#{!bean.costManipulationHelper.isEditable()}">
                <h3>#{msg.estateSituationEditClientName}    <h:outputText value="#{bean.examRequest.clientName}"/></h3>
                <h3>#{msg.estateSituationEditRequestType}   <h:outputText value="#{bean.examRequest.serviceName}"/></h3>
                <h3>#{msg.requestTextEditNumberFormalities} <h:outputText value="#{bean.costManipulationHelper.numberActOrSumOfEstateFormalitiesAndOtherTemp}"/></h3>
                 <c:if test="#{bean.examRequest.showAuthorizedQuote()}">
                	<h3>#{msg.requestTextEditAuthorizedEstimate}
		            	<p:selectBooleanCheckbox id="authorizedEstimate" value="#{bean.examRequest.authorizedQuote}"/>
		            </h3>
		        </c:if>          
                <h3>#{msg.requestTextEditNumberSummaryList} <h:outputText value="#{bean.examRequest.numberOfGroupsByDocumentOfEstateFormality}"/></h3>
                <h3>#{msg.requestTextEditMortgageExpenses}  <h:outputText value="#{bean.costManipulationHelper.costEstateFormalityTemp}"/></h3>
                <h3>#{msg.requestTextEditLandRegistryFees}  <h:outputText value="#{bean.costManipulationHelper.costCadastralTemp}"/></h3>
                <h3>#{msg.requestTextEditCompensation}      <h:outputText value="#{bean.costManipulationHelper.costPayTemp}"/></h3>
                <h3>#{msg.requestTaxableCost}             <h:outputText id="requestTaxableCost" value="#{bean.costManipulationHelper.taxableCostTemp}"/> </h3>
                 <h3>#{msg.requestIncludeNationalCost} 
                     <p:selectBooleanCheckbox id="includeNationalCost" value="#{bean.costManipulationHelper.includeNationalCost}">
                          <p:ajax listener="#{bean.updateNationalCost()}" update="@this requestExtraCostTable includeNationalCostDialog"/>
                     </p:selectBooleanCheckbox>
                 </h3> 
                <h3>#{msg.requestExtraCostInit}             <h:outputText id="requestExtraCostInit" value="#{bean.costManipulationHelper.initCostTemp}"/> </h3>
                <c:if test="#{bean.hideExtraCost ne null and bean.hideExtraCost}">
                	<h3>#{msg.requestCostNote} <h:outputText value="#{bean.costNote}"/></h3>  
                </c:if>
                <c:if test="#{bean.hideExtraCost eq null or not bean.hideExtraCost}">
                	<h3>#{msg.requestExtraCost}</h3>
            	</c:if>
            </c:if>
        </div>

            <p:panelGrid columns="4" styleClass="ui-panelgrid-blank form-group" id="extraCostArea" 
	        	rendered="#{bean.hideExtraCost eq null or not bean.hideExtraCost}">
            <span> #{msg.requestExtraCostMortgage.toUpperCase()}</span>
            <p:column>
                <p:selectOneMenu id="mortgageType" value="#{bean.costManipulationHelper.selectedMortgageNote}" style="width:82%">
                    <f:selectItems value="#{bean.costManipulationHelper.mortgageTypeList}"/>
                </p:selectOneMenu>
            </p:column>
            <p:column>
                <p:spinner id="minMax" value="#{bean.costManipulationHelper.spinnerNumber}" min="0" max="1000" size="1"/>
            </p:column>
            <p:commandButton icon="fa fa-plus" action="#{bean.addExtraCost('IPOTECARIO')}"
                             update="extraCostArea, requestExtraCostTable"/>

            <span> #{msg.requestExtraCostLandRegistry.toUpperCase()}</span>
            <p:column>
                <p:inputText id="inputCostLandRegistry" value="#{bean.costManipulationHelper.extraCostLandRegistry}"/>
            </p:column>
            <p:column/>
            <p:commandButton icon="fa fa-plus" action="#{bean.addExtraCost('CATASTO')}"
                             update="extraCostArea, requestExtraCostTable"/>

            <span> #{msg.requestExtraCostOther.toUpperCase()}</span>
            <p:column>
                <p:inputText id="inputCostOther" value="#{bean.costManipulationHelper.extraCostOther}" placeholder="Costo" />
            </p:column>
           	<p:column>
                <p:inputText id="inputCostOtherNote" value="#{bean.costManipulationHelper.extraCostOtherNote}" placeholder="Descrizione" />
            </p:column>
            <p:commandButton icon="fa fa-plus" action="#{bean.addExtraCost('ALTRO')}"
                             update="extraCostArea, requestExtraCostTable"/>
        </p:panelGrid>


        <p:dataTable scrollable="true" scrollHeight="200" value="#{bean.costManipulationHelper.requestExtraCosts}"
                      var="extraCost" id="requestExtraCostTable" rendered="#{bean.hideExtraCost eq null or not bean.hideExtraCost}">

            <p:column headerText="#{msg.requestExtraCostPrice}">
                <h:outputText value="#{extraCost.price}"/>
            </p:column>
            <p:column headerText="#{msg.requestExtraCostNote}">
                <h:outputText value="#{extraCost.note}"/>
            </p:column>
            <p:column styleClass="action_column">
                <p:commandButton icon="ui-icon ui-icon-close pi pi-trash" update="requestExtraCostTable"
                                 action="#{bean.deleteExtraCost(extraCost)}">
                </p:commandButton>
            </p:column>
        </p:dataTable>
        <div class="btn_line">
            <p:commandButton value="#{msg.confirm}" update="@form"
                             action="#{bean.saveRequestExtraCost}" oncomplete="PF('requestExtraCostDlg').hide();"/>
            
            <p:commandButton value="#{msg.cancel}" oncomplete="PF('requestExtraCostDlg').hide();"/>
        </div>
         <p:dialog id="includeNationalCostDialog" header="Note!" widgetVar="includeNationalCostDialogWV"
	              height="100px">
	        #{msg.requestIncludeNationalCostMessage} <br/>
	        <div class="btn_line">
		        <p:commandButton
		                  value="#{msg.ok}" oncomplete="PF('includeNationalCostDialogWV').hide()"/>
		    </div>
	    </p:dialog>
         <p:dialog id="includeNationalCost2Dialog" header="Note!" widgetVar="includeNationalCost2DialogWV"
	              height="100px">
	        #{msg.requestAlreadyIncludeNationalCostMessage} <br/>
	        <div class="btn_line">
		        <p:commandButton
		                  value="#{msg.ok}" oncomplete="PF('includeNationalCost2DialogWV').hide()"/>
		    </div>
	    </p:dialog>

		

	</p:dialog>
	<p:dialog id="reloadPageDialog" header="Note!"
			widgetVar="reloadPageDialogWV" height="100px">
	     #{msg.reloadPageMessage} <br />
			<div class="btn_line">
				<p:commandButton value="#{msg.confirm}" update="@form"
					action="#{bean.reloadPage}"
					oncomplete="PF('reloadPageDialogWV').hide();" />
				<p:commandButton value="#{msg.cancel}"
					oncomplete="PF('reloadPageDialogWV').hide();" />
			</div>
		</p:dialog>
</ui:composition>
