<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core">
<ui:composition template="/resources/tpl/Admin/Main.xhtml">
    <ui:param name="list_left_title" value="#{msg.cadastralTopologyTitle}"/>
    <ui:param name="left_bean" value="#{cadastralTopologyBean}"/>
    <ui:param name="left_entity_name" value="#{msg.cadastralTopologyTitle}"/>
    <ui:param name="additionalEditAction" value="window.scrollTo(0,0);"/>
    <ui:define name="body">
        <div class="ui-g">
            <div class="ui-g-6">
                <div class="card">
                    <ui:fragment>
                        <h1>#{list_left_title}</h1>
                    </ui:fragment>
                    <div class="content">
                        <h:form id="form" prependId="false">
                            <div class="card card-w-title">
                                <p:panel header="#{msg.cadastralTopologyArticleToAddress}"
                                         rendered="#{left_bean.canCreateInBean}" id="leftEditPanel">
                                    <ui:include src="../../resources/tpl/common/ValidationMessages.xhtml"/>
                                    <div align="center">
                                        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid" style="width: 40%">
                                            <span><span class="red">*</span>#{msg.cadastralTopologyArticle}</span>
                                            <p:inputText value="#{left_bean.entity.article}" id = "article" styleClass="input-width" label="#{msg.cadastralTopologyArticle}"/>
                                            <span><span class="red">*</span>#{msg.cadastralTopologyDescription}</span>
                                            <p:inputText value="#{left_bean.entity.description}" id = "description"  styleClass="input-width" label="#{msg.cadastralTopologyDescription}"/>
                                        </p:panelGrid>
                                        <div>
                                            <p:commandButton value="#{msg.save}" update=":form, messages"
                                                             icon="ui-icon-disk" action="#{left_bean.pageSave}">
                                            </p:commandButton>
                                            <p:commandButton value="#{msg.reset}" update="leftEditPanel"
                                                             icon="ui-icon-circle-close" action="#{left_bean.resetFields}">
                                            </p:commandButton>
                                        </div>
                                    </div>
                                </p:panel>

                                <p:dataTable var="pitem" id="table" value="#{left_bean.lazyModel}"
                                             disabledSelection="#{empty disableSelection?'false':'true'}"
                                             lazy="#{true}" filteredValue="#{left_bean.filteredList}"
                                             paginator="true" rowKey="#{item.id}" rows="10"
                                             selectionMode="single" selection="#{left_bean.selectedItem}" reflow="true"
                                             paginatorAlwaysVisible="true" emptyMessage="#{msg.noRecordsFound}"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             rowsPerPageTemplate="10,20,50" widgetVar="leftTableWV">

                                    <p:column rendered="#{empty showEdit? true : showEdit}"
                                              styleClass="action_column"
                                              exportable="false">

                                        <p:commandButton icon="ui-icon ui-icon-pencil pi pi-pencil"
                                                         disabled="#{!left_bean.canEdit}" update=":form"
                                                         action="#{left_bean.editEntity}" oncomplete="#{additionalEditAction}">
                                            <f:setPropertyActionListener value="#{pitem.id}"
                                                                         target="#{left_bean.entityEditId}"/>
                                        </p:commandButton>
                                    </p:column>

                                    <p:column rendered="#{empty showDelete? true : showDelete}"
                                              styleClass="action_column" exportable="false">
                                        <p:commandButton icon="ui-icon ui-icon-close pi pi-trash"
                                                         oncomplete="PF('dlg2').show()"
                                                         disabled="#{!left_bean.canDelete || (pitem.id==sessionBean.currentUser.id
                                                         and left_bean.userEntityPage)}">
                                            <f:setPropertyActionListener value="#{pitem.id}"
                                                                         target="#{left_bean.entityDeleteId}"/>
                                        </p:commandButton>
                                    </p:column>

                                    <p:column rendered="#{empty showMyDelete ? false : showMyDelete}"
                                              styleClass="action_column" exportable="false">
                                        <p:commandButton icon="ui-icon ui-icon-close pi pi-trash"
                                                         oncomplete="PF('dlg2').show()"
                                                         disabled="#{!left_bean.getCanDelete(pitem) ||
                                                         (item.id==sessionBean.currentUser.id
                                                         and left_bean.userEntityPage)}">
                                            <f:setPropertyActionListener value="#{pitem.id}"
                                                                         target="#{left_bean.entityDeleteId}"/>
                                        </p:commandButton>
                                    </p:column>
                                    <p:column headerText="#{msg.cadastralTopologyArticle}">
                                        <h:outputText value="#{pitem.article}"/>
                                    </p:column>
                                    <p:column headerText="#{msg.cadastralTopologyDescription}">
                                        <h:outputText value="#{pitem.description}"/>
                                    </p:column>
                                </p:dataTable>
                            </div>
                            <p:growl id="messages" showDetail="true" autoUpdate="false"
                                     widgetVar="messagesVar" globalOnly="true"/>
                        </h:form>
                    </div>
                </div>
            </div>
            <ui:include src="./NoCamelCase.xhtml"/>

        </div>
    </ui:define>

</ui:composition>

</html>
