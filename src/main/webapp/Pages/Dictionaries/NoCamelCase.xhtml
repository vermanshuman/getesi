<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:p="http://primefaces.org/ui">
    <ui:param name="list_right_title" value="#{msg.noCamelCaseTitle}"/>
    <ui:param name="right_entity_name" value="#{msg.noCamelCaseTitle}"/>
    <ui:param name="additionalEditAction" value="window.scrollTo(0,0);"/>
            <div class="ui-g-6">
                <div class="card">
                    <ui:fragment>
                        <h1>#{list_right_title}</h1>
                    </ui:fragment>

                    <div class="content">
                        <h:form id="right_form" prependId="false">
                            <div class="card card-w-title">
                                <p:panel header="#{left_bean.panelTitle} #{right_entity_name}"
                                         rendered="#{left_bean.canCreateInBean}" id="rightEditPanel">

                                    <div align="center">
                                        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid" style="width: 40%">
                                            <span><span class="red">*</span>#{msg.cadastralTopologyDescription}</span>
                                            <p:inputText value="#{left_bean.camelCaseDescription}"  id="camelCaseDescription"
                                                         styleClass="input-width" label="#{msg.cadastralTopologyDescription}"/>
                                        </p:panelGrid>
                                        <div>
                                            <p:commandButton value="#{msg.save}" update=":right_form" styleClass="p-mr-2 p-mb-2"
                                                             icon="pi pi-save" action="#{left_bean.saveCamelCase}">
                                            </p:commandButton>
                                            <p:commandButton value="#{msg.reset}" update="rightEditPanel"
                                                             icon="pi pi-times-circle" action="#{left_bean.resetCamelCaseFields}">
                                            </p:commandButton>
                                        </div>
                                    </div>
                                </p:panel>
                                <p:dataTable var="item" id="right_table" value="#{left_bean.lazyCamelModel}"
                                             disabledSelection="#{empty disableSelection?'false':'true'}"
                                             lazy="true"
                                             paginator="true" rowKey="#{item.id}" rows="10"  selectionMode="single" reflow="true"
                                             paginatorAlwaysVisible="true" emptyMessage="#{msg.noRecordsFound}"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             rowsPerPageTemplate="10,20,50" widgetVar="rightTableWV">

                                    <p:column rendered="#{empty showEdit? true : showEdit}"
                                              styleClass="action_column"
                                              exportable="false">

                                        <p:commandButton icon="pi pi-pencil"
                                                         disabled="#{!left_bean.canEdit}"
                                                         update=":right_form"
                                                         action="#{left_bean.editNoCamelCaseEntity}" oncomplete="#{additionalEditAction}">
                                            <f:setPropertyActionListener value="#{item.id}"
                                                                         target="#{left_bean.camelEntityEditId}"/>
                                        </p:commandButton>
                                    </p:column>

                                    <p:column rendered="#{empty showDelete? true : showDelete}"
                                              styleClass="action_column" exportable="false">
                                        <p:commandButton icon="pi pi-times"
                                                         style="background-color: red;border: none !important;"
                                                         oncomplete="PF('camel_dlg').show()"
                                                         disabled="#{!left_bean.canDelete
                                                         || (item.id==sessionBean.currentUser.id and left_bean.userEntityPage)}">
                                            <f:setPropertyActionListener value="#{item.id}"
                                                                         target="#{left_bean.camelEntityDeleteId}"/>
                                        </p:commandButton>
                                    </p:column>

                                    <p:column headerText="#{msg.cadastralTopologyDescription}">
                                        <h:outputText value="#{item.description}"/>
                                    </p:column>
                                </p:dataTable>
                            </div>

                            <p:dialog header="#{msg.deleteConfirmationHeader}" widgetVar="camel_dlg"
                                      modal="true" resizable="false" effect="SLIDE">
                                #{empty deleteMessage ? msg.deleteConfirmation : deleteMessage}<br/>
                                <br/>
                                <div>
                                    <p:commandButton value="#{msg.yes}" action="#{left_bean.deleteCamelEntity}"
                                                     oncomplete="goToPreviousPage();PF('camel_dlg').hide();#{dynamicOnComplete}"
                                                     update="right_table"/>
                                    <p:commandButton value="#{msg.no}" onclick="PF('camel_dlg').hide()"/>
                                </div>

                                <script>
                                    function goToPreviousPage() {
                                        if (PF('rightTableWV').getPaginator().cfg.rowCount
                                            % PF('rightTableWV').getPaginator().cfg.rows == 0) {
                                            var page = PF('rightTableWV').getPaginator()
                                                .getCurrentPage();
                                            if (page > 0) {
                                                PF('rightTableWV').getPaginator().setPage(
                                                    page - 1);
                                            }
                                        }
                                    }
                                </script>
                            </p:dialog>
                        </h:form>
                    </div>
                </div>
            </div>
</ui:composition>
