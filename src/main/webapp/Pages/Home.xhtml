<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ff="http://readytech.com/functions"
                template="/resources/tpl/Admin/template.xhtml">

    <ui:define name="title">Dashboard</ui:define>


    <ui:define name="content">

        <h:outputScript name="chartjs/chart.js" library="chart"/>
        <script type="text/javascript">
            $(function () {
                var chartData = JSON.parse('#{homeBean.chartData}');
                var ctx = document.getElementById("dashboard-chart").getContext('2d');
                var myChart = new Chart(ctx, {
                    type: chartData.type,
                    data: {
                        labels: chartData.labels,
                        datasets: chartData.datasets
                    },
                    options: {
                        responsive: true,
                        hover: {
                            mode: 'index'
                        },
                        scales: {
                            xAxes: [{
                                display: true,
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Month'
                                }
                            }],
                            yAxes: [{
                                display: true,
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Request'
                                }
                            }]
                        },
                        plugins: {
                            tooltip: {}
                        }
                    }
                });
            });
        </script>
        <div class="layout-dashboard" style="max-width: 98%;">
            <h:panelGroup id="slides" layout="block" styleClass="p-grid">
                <div class="p-col-12 p-lg-6 p-xl-3" style="display: #{homeBean.nextSlide ? 'none' : ''}">
                    <div class="overview-box sales" style="background-color: #FF9966;">
                        <i class="overview-icon topbar-icon fa fa-fw fa-envelope-o" style="color:white;"/>
                        <span class="overview-title">#{msg.numberUnreadEmails}</span>
                        <div class="overview-numbers">
                            <h:outputText id="newMailCount"
                                          value="#{sessionBean.newMailCount}"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>
                <div class="p-col-12 p-lg-6 p-xl-3" style="display: #{homeBean.nextSlide ? 'none' : ''}">
                    <div class="overview-box views" style="background-color: #5EA2CC;">
                        <i class="overview-icon fa fa-fw fa-list" style="color:white;"/>
                        <span class="overview-title">Pratiche nuove</span>
                        <div class="overview-numbers">
                            <h:outputText id="numberUnclosedRequests"
                                          value="#{sessionBean.numberUnclosedRequests}"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>
                <div class="p-col-12 p-lg-6 p-xl-3">
                    <div class="overview-box checkin">
                        <i class="overview-icon pi pi-pencil"/>
                        <span class="overview-title">#{msg.numberTotalRequests}</span>
                        <div class="overview-numbers">
                            <h:outputText id="numberUnclosedRequestsInWork"
                                          value="#{sessionBean.numberUnclosedRequestsInWork}"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>
                <div class="p-col-12 p-lg-6 p-xl-3">
                    <div class="overview-box checkin" style="background-color: #DF6161;">
                        <i class="overview-icon pi pi-clock"/>
                        <span class="overview-title">#{msg.numberOverdueRequests}</span>
                        <div class="overview-numbers">
                            <h:outputText
                                    value="&#160;"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>
                <div class="p-col-12 p-lg-6 p-xl-3" style="display: #{homeBean.nextSlide ? '' : 'none'}">
                    <div class="overview-box views">
                        <i class="overview-icon pi pi-calendar"/>
                        <span class="overview-title">#{msg.numberRequestsDue}</span>
                        <div class="overview-numbers">
                            <h:outputText
                                    value="&#160;"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>
                <div class="p-col-12 p-lg-6 p-xl-3" style="display: #{homeBean.nextSlide ? '' : 'none'}">
                    <div class="overview-box checkin" style="background-color: #C488C4;">
                        <i class="overview-icon fa fa-fw fa-database"/>
                        <span class="overview-title">#{msg.numberDBRecords}</span>
                        <div class="overview-numbers">
                            <h:outputText id="sumOfEntriesCountInManyTables"
                                          value="#{sessionBean.sumOfEntriesCountInManyTables}"/>
                        </div>
                        <div class="overview-subinfo">
                        </div>
                    </div>
                </div>

            </h:panelGroup>
            <div class="p-grid">
                <div class="p-col-6">
                    <div>
                        <fieldset>
                            <legend>FRASE DEL GIORNO</legend>
                            <div align="center" style="font-size: 26px; font-style: italic">
                                <i class="fa fa-fw fa-quote-left " style="margin-right: 1%"/>
                                <span>#{homeBean.phrase}</span>
                                <i class="fa fa-fw fa-quote-right" style="margin-left: 1%"/>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <div class="p-col-6">
                    <div>
                        <fieldset>
                            <legend>#{ff:upper(msg.forecastCity)} #{homeBean.currentDayString}</legend>
                            <ui:include src="/Pages/home/WeatherBlock.xhtml"/>
                        </fieldset>
                    </div>
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-12 p-lg-8">
                    <div class="card card-w-title statistics">
                        <h5>#{msg.chartHeader}</h5>
                        <canvas id="dashboard-chart"/>
                    </div>
                </div>
                <div class="p-col-12 p-lg-4">
                    <div class="card card-w-title tasks">
                        <h5 class="carico-heading"><i class="overview-icon pi pi-clone"
                                                      style="color:white;"/>#{msg.workloadHeader}</h5>
                        <div class="p-grid">
                            <div class="p-col-6"></div>
                            <div class="p-col-6">
                                <p:selectOneMenu id="changeUserList" value="#{homeBean.selectedUserId}"
                                                 style="width: 91%;"
                                                 label="#{msg.user}" rendered="#{homeBean.currentUser.isAdmin()}">
                                    <f:selectItems value="#{homeBean.users}"/>
                                </p:selectOneMenu>
                            </div>
                        </div>
                        <ul style="color: #778087;">
                            <ui:repeat value="#{homeBean.workLoadWrappers}" var="workLoad">
                                <li>
                                    <div class="p-grid">
                                        <div class="p-col-1">
                                            <i class="carico-icon topbar-icon #{workLoad.icon}" style="#{workLoad.style}"/>
                                        </div>
                                        <div class="p-col-5">
                                            <div style="font-size: 1.25rem;color: black">
                                                <h:outputText value="#{workLoad.name}"/>
                                            </div>
                                            <div>
                                                <h:outputText
                                                        value="#{workLoad.numberUnclosedRequestsInWork}"/> in lavorazione
                                            </div>
                                        </div>
                                        <div class="p-col-6">
                                            <p:progressBar value="#{workLoad.percentage}" displayOnly="true"
                                                           style="height: .5rem"/>
                                        </div>
                                    </div>

                                </li>
                            </ui:repeat>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div id="layout-config" class="layout-config">
            <div class="layout-config-content">
                <p:commandLink id="slideNextBtn" update=":slides :slideNextBtn"
                               action="#{homeBean.setNextSlide(!homeBean.nextSlide)}" styleClass="layout-config-button"
                               style="background-color: transparent;top: 125px;color: gray;">
                    <i class="pi #{homeBean.nextSlide ? 'pi-angle-double-left' : 'pi-angle-double-right'}"/>
                </p:commandLink>
            </div>
        </div>
    </ui:define>
</ui:composition>
