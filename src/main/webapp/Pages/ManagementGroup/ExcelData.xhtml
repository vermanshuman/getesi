<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:pe="http://primefaces.org/ui/extensions">
<ui:composition template="/resources/tpl/Admin/EmptyBase.xhtml">
	<ui:param name="view_title" value="#{msg.editData}" />
	<ui:param name="bean" value="#{excelDataEdit}" />

	<ui:define name="view_body">
		<style></style>
		<p:panelGrid columns="6" styleClass="ui-panelgrid-blank form-group">
			<h:outputText value="#{msg.client}:"/>
			<p:selectOneMenu id="client_not_manger_or_fiduciary_id"
							 value="#{bean.selectedNotManagerOrFiduciaryClientId}"
							 styleClass="input-width-mmv">
				<f:selectItems value="#{bean.notManagerOrFiduciaryClients}"/>
				<p:ajax event="change" listener="#{bean.initOfficesList}" update="client_fiduciary_id managers mail_ofice_id client_invoice_id"/>
			</p:selectOneMenu>
			<h:outputText value="#{msg.billingCustomer}" />
			<p:selectOneMenu id="client_invoice_id"
							 value="#{bean.excelClientInvoiceId}" styleClass="input-width-mmv">
				<f:selectItems value="#{bean.invoiceClients}" />
			</p:selectOneMenu>
			<h:outputText value=""/>
			<h:outputText value=""/>
			<h:outputText value="#{msg.fatturaN}:"/>
			<p:inputText id="fatturaN" value="#{bean.excelFatturaN}"
						 style="width: 100%" />
			<h:outputText value="#{msg.excelData}:"/>
			<p:calendar id="excelDate" readonlyInput="false" showOn="button"
						onkeypress="if(!searchOnEnter(event, 'searchButton')) return true;"
						pattern="dd/MM/yyyy" mask="true" locale="it" navigator="true"
						popupIconOnly="true"
						onblur="setTimeout(function(){checkDates();}, 500);check_date(this);"
						value="#{bean.excelDate}" placeholder="#{msg.excelData}:" />
			<h:outputText value="#{msg.reportN}:"/>
			<p:inputText id="reportN" value="#{bean.excelReportN}"
						 style="width: 100%" disabled="true"/>

			<h:outputText value="#{msg.subjectViewFormalityConservatoryCap}:"/>
			<p:selectOneMenu id="mail_ofice_id" value="#{bean.selectedOfficeId}" styleClass="input-width-mmv">
				<f:selectItems value="#{bean.officeList}"/>
			</p:selectOneMenu>
			<h:outputText value="#{msg.managerText}"/>
			<p:selectCheckboxMenu id="managers" value="#{bean.selectedClientManagers}" style="width: 100%"
								  label="#{enums.documentGenerationTagsMANAGER}"
								  converter="#{bean.clientSelectItemWrapperConverter}"
								  multiple="true" filter="true" filterMatchMode="startsWith" >
				<f:selectItems value="#{bean.clientManagers}" var="con" itemValue="#{con}"
							   itemLabel="#{con.label}"/>
				<p:ajax process="managers"/>
			</p:selectCheckboxMenu>
			<h:outputText value="#{msg.clientTrust}:"/>
			<p:selectOneMenu id="client_fiduciary_id" value="#{bean.selectedClientFiduciaryId}" styleClass="input-width-mmv">
				<f:selectItems value="#{bean.fiduciaryClientsList}"/>
			</p:selectOneMenu>
			<span> #{msg.ndgText}</span>
			<p:inputText id="ndgShow" value="#{bean.excelReportNDG}"
						 style="width: 100%" />

			<span> #{msg.referenceRequest}</span>
			<p:inputText id="referenceRequest" value="#{bean.referenceRequest}"
						 style="width: 100%" />
		</p:panelGrid>

		<ui:repeat value="#{bean.dataTable}" var="key">
			<p:panelGrid columns="1" styleClass="ui-panelgrid-blank form-group">
				<h:outputText value="#{key.requestName}" style="font-weight:bold;font-size: 20px;" />
				<p:dataTable value="#{key.requestWrappers}" var="req" rowIndexVar="row">
					<p:columns value="#{key.columnNames}" var="column">
						<f:facet name="header">
							<h:outputText value="#{column}" />
						</f:facet>
						<h:outputText value="#{key.columnValues[column.concat('_').concat(req.tempId)]}" />
						<f:facet name="footer">
							<h:outputText value="#{key.footerValues[column]}" style="font-weight:bold;font-size: 15px;"/>
						</f:facet>
					</p:columns>
					<p:column exportable="false" styleClass="action_midle_column">
						<p:commandButton icon="fa fa-pencil-square-o" action="#{bean.viewExtraCost()}">
							<f:setPropertyActionListener value="#{req.requestId}" target="#{bean.requestId}"/>
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</p:panelGrid>
		</ui:repeat>

		<ui:remove>
			<p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group">
				<div class="additional_button">
					<div align="center">
						<p:commandButton id="submit_btn"
										 action="#{bean.generateXlsRequestCost}"
										 value="#{msg.submit}"
										 icon="ui-icon-disk"
										 ajax="false" update="@form"/>
					</div>
				</div>
			</p:panelGrid>
		</ui:remove>
		<p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group additional_button">
			<p:commandButton id="generate_xls"
							 action="#{bean.generateXlsRequestCost}"
							 value="#{msg.submit}"
							 icon="ui-icon-disk"
							 ajax="false" update="@form"/>
			<p:commandButton id="pdf_btn"
							 action="#{bean.generatePdfRequestCost}"
							 value="#{msg.pdf}"
							 icon="fa fa-fw fa-file-pdf-o"
							 ajax="false" update="@form"/>
		</p:panelGrid>
		<ui:include src="../Dialogs/RequestExtraCostDialog.xhtml"/>
	</ui:define>
</ui:composition>
</html>
