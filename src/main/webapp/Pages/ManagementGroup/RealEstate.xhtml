<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/resources/tpl/Admin/EditBase.xhtml">
    <ui:param name="bean" value="#{realEstateBean}"/>
    <ui:param name="edit_title"
              value="#{bean.entity.isNew ? msg.databaseListRealEstateNew : msg.databaseListRealEstateEdit}"/>
    <ui:param name="renderSideMenu" value="#{bean.renderHeader}"/>
    <ui:param name="centerPartStyleClass" value="false"/>
    <ui:param name="showSave" value="#{!bean.onlyView and bean.showSave}"/>
    <ui:param name="showCancel" value="#{bean.showCancel}"/>
    <ui:param name="notShowMenu" value="#{!bean.renderHeader}"/>
    <ui:param name="renderHeaderMenu" value="#{bean.renderHeader}"/>
    <ui:param name="renderFooterMenu" value="#{bean.renderFooter}"/>
    <ui:param name="customCancelMsg"
              value="#{bean.onlyView ? msg.close : msg.cancel}"/>

    <ui:define name="edit_body">
        <style type="text/css">
            .card fieldset {
                border: 1px solid #6c757d !important;
            }
            body .ui-fieldset .ui-fieldset-legend {
                border: 1px solid #dee2e6 !important;
                color: #FFFFFF !important;
                padding: 0.6em 1em !important;
                font-weight: normal !important;
                border-radius: 4px !important;
                user-select: none !important;
                font-size: 14px !important;
                transition: background-color 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
            }
            fieldset div {
                font-size: 14px !important;
                text-align: left !important;
            }
        </style>

        <p:panelGrid columns="4" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-0, ui-grid-col-0, ui-grid-col-0, ui-grid-col-0">

            <ui:fragment>
                <span class="red">*</span>
                <h:outputText value="#{msg.databaseListRealEstateProvince}:"/>
            </ui:fragment>
            <ui:fragment>
                <p:selectOneMenu id="province" value="#{bean.addressProvinceId}"
                                 label="#{msg.databaseListSubjectProvince}:" styleClass="select-width"
                                 rendered="#{!bean.onlyView}">
                    <p:ajax update="province, city, messages"
                            listener="#{realEstateBean.handleAddressProvinceChange}"/>
                    <f:selectItems value="#{bean.provinces}"/>
                </p:selectOneMenu>
                <h:outputText value="#{bean.provinceDescription}"
                              rendered="#{bean.onlyView}" style="font-weight: bold;"/>
            </ui:fragment>

            <ui:fragment>
                <span class="red" style="margin-left: 100px;">*</span>
                <h:outputText value="#{msg.databaseListRealEstateCity}:"/>
            </ui:fragment>

            <ui:fragment>
                <p:selectOneMenu id="city" value="#{bean.addressCityId}" styleClass="select-width"
                                 label="#{msg.databaseListSubjectCity}:"
                                 rendered="#{!bean.onlyView}">
                    <f:selectItems value="#{bean.addressCities}"/>
                </p:selectOneMenu>
                <h:outputText value="#{bean.cityDescription}"
                              rendered="#{bean.onlyView}" style="font-weight: bold;"/>
            </ui:fragment>

            <ui:fragment>
                <h:outputText value="#{msg.databaseListRealEstateZona}: "/>
                <p:inputText id="propertyZone" value="#{bean.zone}" style="width: 200px;"/>
                <p:commandButton value="#{msg.databaseListRealEstateKMLFileUpload}" action="#{bean.findZoneByKMLFile}"
                                 update="propertyZone, :form:messages"/>
            </ui:fragment>
        </p:panelGrid>
        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-1, ui-grid-col-3">
            <span><span class="red">*</span>
                #{msg.databaseListRealEstateType}:</span>
            <p:selectOneRadio value="#{bean.entity.type}" id="realEstateType"
                              disabled="#{bean.onlyView}" onchange="updateForm();">
                <f:selectItems value="#{bean.realEstateTypes}"/>
            </p:selectOneRadio>
        </p:panelGrid>

        <h:outputText value="&#160;"/>
        <p:fieldset legend="#{msg.databaseListRealEstateLeadingPropertyData}" collapsed="false" toggleable="true">
            <p:panelGrid columns="3" styleClass="ui-panelgrid-blank form-group"
                         columnClasses="ui-grid-col-0,ui-grid-col-0,ui-grid-col-0" layout="grid"
                         cellpadding="0" cellspacing="0" rendered="#{!bean.onlyView and bean.isBuilding}">
                <p:selectBooleanCheckbox id="schedaCheckBox" value="#{bean.saveScheda}" onchange="updateForm();"/>
                <span class="centered">#{msg.databaseListRealEstateCadastralText}</span>
                <p:inputText value="#{bean.newCadastralData.scheda}" styleClass="input-width" id='schedaText'
                             placeholder="#{msg.databaseListRealEstateCadastralNoteText}"
                             disabled="#{not bean.saveScheda}"/>
            </p:panelGrid>


            <p:panelGrid columns="5" styleClass="ui-panelgrid-blank form-group" layout="grid"
                         columnClasses="ui-grid-col-3, ui-grid-col-3, ui-grid-col-3, ui-grid-col-3"
                         id="addCadastralDataDLGPanel"
                         rendered="#{!bean.onlyView}">

                <p:inputText value="#{bean.newCadastralData.section}" styleClass="input-width"
                             placeholder="#{msg.databaseListRealEstateSection}"/>
                <p:inputText value="#{bean.newCadastralData.sheet}" styleClass="input-width"
                             id="addCadastralDataDLGsheet" placeholder="#{msg.databaseListRealEstateSheet}"/>
                <p:inputText value="#{bean.newCadastralData.particle}" styleClass="input-width"
                             id="addCadastralDataDLGparticle" placeholder="#{msg.databaseListRealEstateParticle}"/>
                <p:inputText value="#{bean.newCadastralData.sub}" styleClass="input-width"
                             id="addCadastralDataDLGsub" placeholder="#{msg.databaseListRealEstateSub}"/>
                <div class="btn_line">
                    <p:commandButton value="#{msg.databaseListRealEstateAddNewBtn}"
                                     action="#{bean.addCadastralData}"
                                     update="addCadastralDataDLGPanel schedaCheckBox schedaText"/>
                </div>
            </p:panelGrid>
            <p:dataTable var="item" id="tableCadastralData"
                         emptyMessage="#{msg.noRecordsFound}" value="#{bean.cadastralData}"
                         rowKey="#{item.id}" rows="10" paginator="true"
                         paginatorAlwaysVisible="true" rowIndexVar="rowId"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="tableCDWV">

                <p:column headerText="#{msg.databaseListRealEstateSection}">
                    <h:outputText value="#{item.section}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateSheet}">
                    <h:outputText value="#{item.sheet}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateParticle}">
                    <h:outputText value="#{item.particle}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateSub}">
                    <h:outputText value="#{item.sub}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateAction}"
                          rendered="#{not bean.onlyView}">
                    <p:commandButton value="#{msg.delete}"
                                     oncomplete="PF('deleteCadastralDataDLGWV').show();">
                        <f:setPropertyActionListener value="#{item.tempId}"
                                                     target="#{bean.deleteTempId}"/>
                    </p:commandButton>
                </p:column>

            </p:dataTable>

        </p:fieldset>
        <h:outputText value="&#160;"/>
        <p:panelGrid columns="4" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-0, ui-grid-col-0, ui-grid-col-0, ui-grid-col-0 "
                     rendered="#{!bean.onlyView and bean.isBuilding}">
            <h:outputText value="#{msg.databaseListRealEstateCategory}:"/>
            <p:column>
                <p:selectOneMenu id="category" value="#{bean.categoryId}" styleClass="select-width"
                                 label="#{msg.databaseListRealEstateCategory}:" rendered="#{!bean.onlyView}">
                    <f:selectItems value="#{bean.categories}"/>
                    <p:ajax update="categoryDesc"/>
                </p:selectOneMenu>
                <h:outputText value="#{bean.categoryCode}" rendered="#{bean.onlyView}" style="font-weight: bold;"/>
            </p:column>
            <h:outputText value="#{msg.estateType}:" style="margin-left: 100px;"/>
            <h:outputText value="#{bean.categoryDescription}" id="categoryDesc"
                          style="#{bean.onlyView?'font-weight: bold;': ''}"/>
        </p:panelGrid>

        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-1, ui-grid-col-3" rendered="#{bean.isBuilding}">

            <h:outputText value="#{msg.databaseListRealEstateAddress}:" rendered="#{bean.isBuilding}"/>
            <p:inputTextarea value="#{bean.entity.address}"
                             maxlength="300" rendered="#{bean.isBuilding and (!bean.onlyView)}" rows="5" cols="100"/>
            <h:outputText value="#{bean.entity.address}"
                          rendered="#{bean.isBuilding and bean.onlyView}" style="font-weight: bold;"/>
            <h:outputText value="#{msg.databaseListRealEstateFloor}:"/>

            <p:inputText value="#{bean.entity.floor}" styleClass="input-width"
                         rendered="#{!bean.onlyView}" maxlength="10"/>
            <h:outputText value="#{bean.entity.floor}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateConsistency}:"/>
            <p:inputText value="#{bean.entity.consistency}" maxlength="30" styleClass="input-width"
                         rendered="#{!bean.onlyView}"/>
            <h:outputText value="#{bean.entity.consistency}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateRevenue}:"/>
            <p:inputText value="#{bean.entity.revenue}" maxlength="30" styleClass="input-width"
                         onkeypress="currency_field_only('#revenue');" id="revenue"
                         rendered="#{!bean.onlyView}"/>
            <h:outputText value="#{bean.entity.revenue}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateArea}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.area}" rendered="#{bean.onlyView}"
                          style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateMicroZone}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.microZone}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>
        </p:panelGrid>

        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-1, ui-grid-col-3" rendered="#{not bean.isBuilding}">

            <h:outputText value="#{msg.databaseListRealEstateHectares}:"/>
            <p:inputText value="#{bean.entity.hectares}" styleClass="input-width"
                         rendered="#{!bean.onlyView}"
                         onkeypress="return numbers_only(this, event, 10, 10)"
                         onkeyup="check_numbers(this, 10, 10);"/>
            <h:outputText value="#{bean.entity.hectares}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateAres}:"/>
            <p:inputText value="#{bean.entity.ares}" rendered="#{!bean.onlyView}" styleClass="input-width"
                         onkeypress="return numbers_only(this, event, 10, 10)"
                         onkeyup="check_numbers(this, 10, 10);"/>
            <h:outputText value="#{bean.entity.ares}" rendered="#{bean.onlyView}"
                          style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateCentiares}:"/>
            <p:inputText value="#{bean.entity.centiares}" styleClass="input-width"
                         onkeypress="return numbers_only(this, event, 10, 10)"
                         onkeyup="check_numbers(this, 10, 10);" rendered="#{!bean.onlyView}"/>
            <h:outputText value="#{bean.entity.centiares}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstatePortion}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.portion}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText value="#{msg.databaseListRealEstateQuality}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.quality}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>
        </p:panelGrid>

        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-1, ui-grid-col-3" rendered="#{bean.isBuilding}">

            <h:outputText value="#{msg.databaseListRealEstateCadastralArea}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.cadastralArea}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>


        </p:panelGrid>

        <h:outputText value="&#160;"/>
        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                     columnClasses="ui-grid-col-1, ui-grid-col-3" rendered="#{not bean.isBuilding}">

            <h:outputText value="#{msg.databaseListRealEstateDeduction}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.deduction}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>


            <h:outputText value="#{msg.databaseListRealEstateCadastralIncome}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.cadastralIncome}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>

            <h:outputText
                    value="#{msg.databaseListRealEstateAgriculturalIncome}:" rendered="#{bean.onlyView}"/>
            <h:outputText value="#{bean.entity.agriculturalIncome}"
                          rendered="#{bean.onlyView}" style="font-weight: bold;"/>
        </p:panelGrid>

        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group"
                     rendered="#{(not bean.isBuilding) and bean.onlyView}">
            <h:outputText value="#{msg.databaseListRealEstateAddress}:"/>
            <h:outputText value="#{bean.entity.address}" style="font-weight: bold;"/>

        </p:panelGrid>

        <h:outputText value="&#160;"/>

        <p:fieldset legend="#{msg.databaseListRealEstateSubjects}" collapsed="false" toggleable="true">

            <div class="btn_line" style="text-align:left;margin-bottom: 10px;">
                <p:commandButton oncomplete="PF('addSubjectDLGWV').show();"
                                 value="#{msg.databaseListRealEstateAddSubject}"
                                 update=":form:addSubjectPanel" action="#{bean.addRelationship}"/>
            </div>
            <p:dataTable var="item" id="tableSubjects"
                         emptyMessage="#{msg.noRecordsFound}" value="#{bean.subjectWrappers}"
                         rowKey="#{item.id}" rows="10" paginator="true"
                         paginatorAlwaysVisible="true" rowIndexVar="rowId"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="tableSubjectsWV">

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon ui-icon-pencil"
                                     oncomplete="PF('addSubjectDLGWV').show();"
                                     update=":form:addSubjectPanel" action="#{bean.editRelationship}">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.relationshipEditId}"/>
                    </p:commandButton>
                </p:column>

                <p:column styleClass="action_column" exportable="false">
                    <p:commandButton icon="ui-icon ui-icon-close"
                                     oncomplete="PF('deleteSubjectDLGWV').show()">
                        <f:setPropertyActionListener value="#{item.id}"
                                                     target="#{bean.relationshipDeleteId}"/>
                    </p:commandButton>
                </p:column>

                <p:column headerText="#{msg.invoicesRecipientCompanyName}">
                    <h:outputText value="#{item.businessName}"/>
                </p:column>

                <p:column headerText="#{msg.searchName}">
                    <h:outputText value="#{item.name}"/>
                </p:column>

                <p:column headerText="#{msg.searchSurname}">
                    <h:outputText value="#{item.surname}"/>
                </p:column>

                <p:column headerText="#{msg.searchBirthDay}">
                    <h:outputText value="#{item.birthDate}"
                                  converter="dateTimeConverter"/>
                </p:column>

                <p:column headerText="#{msg.searchFiscalCode}">
                    <h:outputText value="#{item.fiscalCode}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateQuote}">
                    <h:outputText value="#{item.quote}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstatePropertyType}">
                    <h:outputText value="#{item.propertyTypeStr}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateSubjectType}">
                    <h:outputText value="#{item.relationship.document.typeDescription eq null ? msg.databaseListRealEstateSubjectTypeManual:
                    item.relationship.document.typeDescription}"/>
                </p:column>

                <p:column styleClass="action_column">
                    <p:commandButton icon="fa fa-download" rendered="#{item.relationship.document.canDownload}"
                                     action="#{bean.downloadFile}" ajax="false" update="@form">
                        <f:setPropertyActionListener value="#{item.relationship.document.id}"
                                                     target="#{bean.downloadFileId}"/>
                    </p:commandButton>
                </p:column>

            </p:dataTable>

        </p:fieldset>

        <h:outputText value="&#160;"/>
        <p:panel header="#{msg.databaseListRealEstateDocuments}" rendered="#{bean.onlyView}">
            <p:dataTable var="item" id="tableDocuments"
                         emptyMessage="#{msg.noRecordsFound}"
                         value="#{bean.documentWrappers}" rowKey="#{item.id}" rows="10"
                         paginator="true" paginatorAlwaysVisible="true" rowIndexVar="rowId"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="tableDocumentsWV">

                <p:column headerText="#{msg.databaseListDocumentTitle}">
                    <h:outputText value="#{item.document.title}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListDocumentTypes}">
                    <h:outputText value="#{item.document.typeDescription}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListDocumentDate}">
                    <h:outputText value="#{item.document.date}"
                                  converter="dateTimeConverter"/>
                </p:column>

                <p:column styleClass="action_column">
                    <p:commandButton icon="fa fa-download"
                                     action="#{bean.downloadFile}" ajax="false" update="@form">
                        <f:setPropertyActionListener value="#{item.document.id}"
                                                     target="#{bean.downloadFileId}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <div class="btn_line">
                <p:commandButton value="#{msg.databaseListDocumentAdd}"
                                 id="addDocumentBtn" oncomplete="PF('documentAddDlgWV').show();"/>
            </div>
        </p:panel>

        <h:outputText value="&#160;"/>
        <p:panel header="#{msg.databaseListRealEstateComment}" rendered="#{bean.isBuilding}">
            <p:inputTextarea value="#{bean.entity.comment}" rows="10" style="width: 99%;"
                             rendered="#{!bean.onlyView}"/>
            <h:outputText value="#{bean.entity.comment}" rendered="#{bean.onlyView}"
                          style="font-weight: bold;"/>
        </p:panel>

        <p:panel header="#{msg.databaseListRealEstateEstimateOMI}:" rendered="#{!bean.onlyView}">

            <p:dataTable var="item" id="tableEstimateOMI"
                         emptyMessage="#{msg.noRecordsFound}"
                         value="#{bean.estimateOMIHistory}" rowKey="#{item.id}" rows="10"
                         paginator="true" paginatorAlwaysVisible="true" rowIndexVar="rowId"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="tableEstimateOMIWV">

                <p:column headerText="#{msg.databaseListRealEstateEstimateOMIValue}">
                    <h:outputText value="#{item.estimateOMI}"/>
                </p:column>

                <p:column headerText="#{msg.databaseListRealEstateEstimateOMIDate}">
                    <h:outputText value="#{item.propertyAssessmentDate}"
                                  converter="dateTimeConverter"/>
                </p:column>

                <p:column headerText="#{msg.databaseListDocumentCreateUserFullName}">
                    <h:outputText value="#{item.user}"/>
                </p:column>

            </p:dataTable>
            <div class="btn_line">
                <p:commandButton oncomplete="PF('addNewOMIDlgWV').show();"
                                 rendered="#{not bean.onlyView}"
                                 value="#{msg.databaseListRealEstateEstimateOMIAdd}"/>
            </div>
        </p:panel>
        <p:panel header="#{msg.databaseListRealEstateCommercialValue}:"
                 rendered="#{!bean.onlyView}">

            <p:dataTable var="item" id="tableCommercialValue"
                         emptyMessage="#{msg.noRecordsFound}"
                         value="#{bean.commercialValueHistory}" rowKey="#{item.id}" rows="10"
                         paginator="true" paginatorAlwaysVisible="true" rowIndexVar="rowId"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,50" widgetVar="tableCommercialValueWV">

                <p:column headerText="#{msg.databaseListRealEstateCommercialValue}">
                    <h:outputText value="#{item.commercialValue}"/>
                </p:column>

                <p:column
                        headerText="#{msg.databaseListRealEstateCommercialValueDate}">
                    <h:outputText value="#{item.commercialValueDate}"
                                  converter="dateTimeConverter"/>
                </p:column>

                <p:column headerText="#{msg.databaseListDocumentCreateUserFullName}">
                    <h:outputText value="#{item.user}"/>
                </p:column>

            </p:dataTable>
            <div class="btn_line">
                <p:commandButton
                        oncomplete="PF('addNewCommercialValueDlgWV').show();"
                        rendered="#{not bean.onlyView}"
                        value="#{msg.databaseListRealEstateCommercialValueAdd}"/>
            </div>
        </p:panel>

        <p:remoteCommand name="updateForm" update=":form"/>

        <p:dialog header="#{msg.databaseListDocumentAddDlg}" modal="true"
                  id="documentAddDlg" resizable="false" draggable="false"
                  dynamic="true" widgetVar="documentAddDlgWV">
            <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group">
                <h:outputText value="#{msg.databaseListDocumentTypes}:"/>
                <p:selectOneMenu value="#{bean.selectedTypeId}" id="documentType">
                    <f:selectItems value="#{bean.documentTypes}"/>
                </p:selectOneMenu>

                <h:outputText value="#{msg.databaseListDocumentTitle}:"/>
                <p:inputText value="#{bean.documentTitle}"/>

                <h:outputText value="#{msg.databaseListDocumentDocument}:"/>
                <p:fileUpload mode="simple" value="#{bean.document}" skinSimple="true"
                              label="#{msg.mailManagerChooseAttachedFiles}"
                              uploadLabel="#{msg.mailManagerUploadAttachedFiles}"
                              cancelLabel="#{msg.mailManagerCancelAttachedFiles}"/>

                <h:outputText value="#{msg.databaseListDocumentDate}:"/>
                <p:calendar id="documentDate" pattern="dd/MM/yyyy" mask="true" showOn="button"
                            locale="it" navigator="true" popupIconOnly="true"
                            value="#{bean.documentDate}"/>
            </p:panelGrid>
            <div class="btn_line">
                <p:commandButton value="#{msg.save}" ajax="false"
                                 action="#{bean.saveFile}"
                                 oncomplete="PF('documentAddDlgWV').hide();"/>
                <p:commandButton value="#{msg.cancel}" ajax="false"
                                 action="#{bean.cancelSaveFile}"
                                 oncomplete="PF('documentAddDlgWV').hide();"/>
            </div>

        </p:dialog>

        <p:dialog widgetVar="xmlMultiSubjectsDlgWV" resizable="false"
                  draggable="false" modal="true">

            <p:panel header="#{bean.currentDocumentWrapper.dialogHeader}"
                     id="xmlMultiSubjectPanel">
                <p:dataTable var="item" id="xmlMultiSubjectTable"
                             emptyMessage="#{msg.noRecordsFound}"
                             value="#{bean.currentDocumentWrapper.subjects}"
                             rowKey="#{item.tempId}" rows="10" paginator="true"
                             paginatorAlwaysVisible="true" rowIndexVar="rowId"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,20,50" widgetVar="xmlMultiSubjectTableWV"
                             selection="#{bean.currentDocumentWrapper.selectedSubject}">

                    <p:column selectionMode="single"
                              style="width:16px;text-align:center"/>

                    <p:column headerText="#{msg.lastname}">
                        <h:outputText value="#{item.surname}"/>
                    </p:column>

                    <p:column headerText="#{msg.name}">
                        <h:outputText value="#{item.name}"/>
                    </p:column>

                    <p:column headerText="#{msg.databaseListSubjectBirthDate}">
                        <h:outputText value="#{item.birthDate}"
                                      converter="dateTimeConverter"/>
                    </p:column>

                    <p:column headerText="#{msg.databaseListSubjectSex}">
                        <h:outputText value="#{item.sexType}" converter="enumConverter"/>
                    </p:column>

                    <p:column headerText="#{msg.databaseListSubjectFiscalCode}">
                        <h:outputText value="#{item.fiscalCode}"/>
                    </p:column>

                    <p:column headerText="#{msg.databaseListSubjectCity}">
                        <h:outputText value="#{item.birthCity}"/>
                    </p:column>

                    <p:column headerText="#{msg.databaseListSubjectProvince}">
                        <h:outputText value="#{item.birthProvince}"/>
                    </p:column>
                </p:dataTable>
                <div class="btn_line">
                    <p:commandButton value="#{msg.save}"
                                     action="#{bean.handleSpecialMultiSubjectFlow}"
                                     onclick="PF('xmlMultiSubjectsDlgWV').hide();"
                                     update=":form:xmlMultiSubjectPanel"/>
                    <p:commandButton value="#{msg.cancel}"
                                     action="#{bean.chooseNextSubject}"
                                     update=":form:xmlMultiSubjectPanel"
                                     onclick="PF('xmlMultiSubjectsDlgWV').hide();"/>
                </div>
            </p:panel>
        </p:dialog>

        <p:dialog draggable="false" id="deleteSubjectDLG" modal="true"
                  resizable="false" widgetVar="deleteSubjectDLGWV">
            <h:outputText value="#{msg.databaseListRealEstateDeleteSubject}"/>
            <div class="btn_line">
                <p:commandButton value="#{msg.confirm}" update=":form:tableSubjects"
                                 action="#{bean.deleteSubject}"
                                 oncomplete="PF('deleteSubjectDLGWV').hide();"/>
                <p:commandButton value="#{msg.cancel}"
                                 oncomplete="PF('deleteSubjectDLGWV').hide();"/>
            </div>
        </p:dialog>

        <p:dialog draggable="false" id="addSubjectDLG" modal="true"
                  resizable="false" widgetVar="addSubjectDLGWV" width="575">
            <p:outputPanel id="addSubjectPanel">
                <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group" layout="grid"
                             columnClasses="ui-grid-col-3, ui-grid-col-9">
					<span style="white-space: nowrap;"><span class="red">*</span>
                        #{msg.databaseListRealEstateSubject}:</span>
                    <ui:fragment>
                        <p:autoComplete id="acSimple" value="#{bean.selectedSubject}" var="item" itemLabel="#{item}"
                                        itemValue="#{item}" maxResults="9"
                                        completeMethod="#{bean.filterSubjects}"/>
                        <!--<p:selectOneMenu filter="true" filterFunction="#{bean.filterSubjects}"-->
                        <!--id="allSubjects" value="#{bean.selectedSubject}"-->
                        <!--label="#{msg.databaseListRealEstateSubject}">-->
                        <!--<f:selectItems value="#{bean.allSubjects}"/>-->
                        <!--</p:selectOneMenu>-->
                        <p:commandButton icon="pi pi-plus-circle"
                                         action="#{bean.openSubjectDlg}">
                            <p:ajax event="dialogReturn"
                                    listener="#{bean.onEditSubjectDlgClose}"
                                    update=":form:addSubjectPanel"/>
                        </p:commandButton>
                    </ui:fragment>

                    <span> #{msg.databaseListRealEstateQuote}:</span>
                    <p:column>
                        <p:inputText id="inputQuote1" value="#{bean.editSubjectWrapper.quote1}"
                                     onkeypress="numbers_only('#inputQuote1');"/>
                        <h:outputText value=" / "/>
                        <p:inputText id="inputQuote2" value="#{bean.editSubjectWrapper.quote2}"
                                     onkeypress="numbers_only('#inputQuote2');"/>
                    </p:column>
                    <span> #{msg.databaseListRealEstatePropertyType}:</span>
                    <p:selectOneMenu value="#{bean.editSubjectWrapper.propertyType}">
                        <f:selectItems value="#{bean.editSubjectWrapper.propertyTypeList}"/>
                    </p:selectOneMenu>
                </p:panelGrid>
                <div class="btn_line">
                    <p:commandButton value="#{msg.save}"
                                     action="#{bean.saveRelationship}" styleClass="save-btn p-mr-2 p-mb-2"
                                     update=":form:addSubjectPanel, :form:tableSubjects, messages"/>
                    <p:commandButton value="#{msg.cancel}" styleClass="annula-btn"
                                     oncomplete="PF('addSubjectDLGWV').hide();"/>
                </div>
            </p:outputPanel>
        </p:dialog>

        <p:dialog draggable="false" id="deleteCadastralDataDLG" modal="true"
                  header="#{msg.databaseListRealEstateDeleteNewCadastralDataDLG}"
                  resizable="false" widgetVar="deleteCadastralDataDLGWV">
            <h:outputText
                    value="#{msg.databaseListRealEstateDeleteNewCadastralDataDLGQuestion}"/>

            <div class="btn_line">
                <p:commandButton value="#{msg.yes}"
                                 action="#{bean.deleteCadastralData}"
                                 oncomplete="PF('deleteCadastralDataDLGWV').hide();updateForm();"/>
                <p:commandButton value="#{msg.no}"
                                 oncomplete="PF('deleteCadastralDataDLGWV').hide();"/>
            </div>
        </p:dialog>

        <p:dialog draggable="false" id="addNewOMIDlg" modal="true"
                  header="#{msg.databaseListRealEstateEstimateOMI}" resizable="false"
                  widgetVar="addNewOMIDlgWV">

            <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group"
                         id="addNewOMIDlgPanel">
                <h:outputText value="#{msg.databaseListRealEstateEstimateOMIValue}:"/>
                <p:inputText value="#{bean.currencyValue}" id="estimateOMIValue"
                             label="#{msg.databaseListRealEstateEstimateOMIValue}"/>

                <h:outputText value="#{msg.databaseListRealEstateEstimateOMIDate}:"/>
                <p:calendar id="dateEstimateOMI" styleClass="search_group" showOn="button"
                            pattern="dd/MM/yyyy" mask="true" locale="it" navigator="true"
                            popupIconOnly="true" value="#{bean.currencyDate}"
                            yearRange="c-10:c+10"/>
            </p:panelGrid>

            <div class="btn_line">
                <p:commandButton value="#{msg.save}"
                                 action="#{bean.addNewEstimateOMI}"
                                 update=":form:addNewOMIDlgPanel, :form:tableEstimateOMI"/>
                <p:commandButton value="#{msg.cancel}" action="#{bean.cancelSave}"
                                 update=":form:addNewOMIDlgPanel"
                                 oncomplete="PF('addNewOMIDlgWV').hide();"/>
            </div>
        </p:dialog>

        <p:dialog draggable="false" id="addNewCommercialValueDlg" modal="true"
                  header="#{msg.databaseListRealEstateCommercialValue}"
                  resizable="false" widgetVar="addNewCommercialValueDlgWV">

            <p:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group"
                         id="addNewComValPanel">
                <h:outputText value="#{msg.databaseListRealEstateCommercialValue}:"/>
                <p:inputText value="#{bean.commercialValue}" id="commercialValue"
                             label="#{msg.databaseListRealEstateCommercialValue}"/>

                <h:outputText
                        value="#{msg.databaseListRealEstateCommercialValueDate}:"/>
                <p:calendar id="dateComVal" showOn="button"
                            pattern="dd/MM/yyyy" mask="true" locale="it" navigator="true"
                            popupIconOnly="true" value="#{bean.commercialDate}"
                            yearRange="c-10:c+10"/>
            </p:panelGrid>

            <div class="btn_line">
                <p:commandButton value="#{msg.save}"
                                 action="#{bean.addNewCommercialValue}"
                                 update=":form:addNewComValPanel, :form:tableCommercialValue"/>
                <p:commandButton value="#{msg.cancel}" action="#{bean.cancelSave}"
                                 update=":form:addNewComValPanel"
                                 oncomplete="PF('addNewCommercialValueDlgWV').hide();"/>
            </div>
        </p:dialog>

    </ui:define>

    <ui:define name="additional_buttons">
        <p:commandButton value="#{msg.edit}"
                         rendered="#{bean.onlyView}"
                         update=":form" action="#{bean.editSubject}"
                         icon="ui-icon ui-icon-pencil"/>
        <p:commandButton value="#{msg.save}"
                         rendered="#{bean.fromRequestPrint and not bean.fromSubjectView}"
                         update=":form" action="#{bean.saveFromDialog}"
                         icon="ui-icon ui-icon-disk"/>
        <p:commandButton action="#{bean.closeDialog}"
                         rendered="#{bean.fromRequestPrint and not bean.fromSubjectView}"
                         value="#{msg.cancel}" icon="ui-icon-circle-close"/>
    </ui:define>

    <ui:define name="scripts">
        <script>
            function onEstimateOMIChange() {
                $('#dateEstimateOMI_input').val(getCurrentDate());
            }

            function onCommercialValueChange() {
                $('#commercialValueDate_input').val(getCurrentDate());
            }
        </script>
    </ui:define>

</ui:composition>
